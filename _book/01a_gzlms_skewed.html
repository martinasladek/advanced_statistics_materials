<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>1&nbsp; Modelling skewness – Advanced Statistics 25/26</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./01b_gzlms_counts.html" rel="next">
<link href="./01_gzlms.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="site_libs/datatables-binding-0.33/datatables.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="assets/webex.css">
<link rel="stylesheet" href="assets/custom.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01_gzlms.html">Generalised Linear Models</a></li><li class="breadcrumb-item"><a href="./01a_gzlms_skewed.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Modelling skewness</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Advanced Statistics 25/26</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome to Advanced Statistics</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./01_gzlms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Generalised Linear Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01a_gzlms_skewed.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Modelling skewness</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01b_gzlms_counts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Modelling counts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01c_gzlms_ordinal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Modelling ordinal outcomes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01d_gzlms_summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./02_ma.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Meta-analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02a_ma_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Introduction to meta-analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02b_ma_advanced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Advanced meta-analytic methods</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02c_ma_assessment_support.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Assessment support</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./03_measurement.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Measurement</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03a_measurement_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">EFA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03b_measurement_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">CFA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03c_measurement_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Measurement invariance</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_cex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Computer Exam</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_open_topic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Open Topic</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="4">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#gamma-models" id="toc-gamma-models" class="nav-link active" data-scroll-target="#gamma-models"><span class="header-section-number">1.1</span> Gamma models</a>
  <ul>
  <li><a href="#data-visualisation" id="toc-data-visualisation" class="nav-link" data-scroll-target="#data-visualisation">Data visualisation</a></li>
  <li><a href="#link-functions" id="toc-link-functions" class="nav-link" data-scroll-target="#link-functions">Link functions</a>
  <ul class="collapse">
  <li><a href="#canonical-link-functions" id="toc-canonical-link-functions" class="nav-link" data-scroll-target="#canonical-link-functions">Canonical link functions</a></li>
  </ul></li>
  <li><a href="#fit-the-model" id="toc-fit-the-model" class="nav-link" data-scroll-target="#fit-the-model">Fit the model</a></li>
  <li><a href="#check-model-assumptions" id="toc-check-model-assumptions" class="nav-link" data-scroll-target="#check-model-assumptions">Check model assumptions</a></li>
  <li><a href="#check-model-fit" id="toc-check-model-fit" class="nav-link" data-scroll-target="#check-model-fit">Check model fit</a></li>
  <li><a href="#sec-gamma-params" id="toc-sec-gamma-params" class="nav-link" data-scroll-target="#sec-gamma-params">Parameter estimates</a></li>
  <li><a href="#sec-report-gamma" id="toc-sec-report-gamma" class="nav-link" data-scroll-target="#sec-report-gamma">Report</a></li>
  </ul></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">1.2</span> Exercises</a>
  <ul>
  <li><a href="#what-does-this-code-do" id="toc-what-does-this-code-do" class="nav-link" data-scroll-target="#what-does-this-code-do">What does this code do?</a></li>
  <li><a href="#worksheet" id="toc-worksheet" class="nav-link" data-scroll-target="#worksheet">Worksheet</a></li>
  <li><a href="#check-worksheet-values" id="toc-check-worksheet-values" class="nav-link" data-scroll-target="#check-worksheet-values">Check worksheet values</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01_gzlms.html">Generalised Linear Models</a></li><li class="breadcrumb-item"><a href="./01a_gzlms_skewed.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Modelling skewness</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="modelling-skewness" class="quarto-section-identifier"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Modelling skewness</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In the previous section, we’ve learned about the limitations of fitting (robust or non robust) straight lines through data. If we make incorrect assumptions about the data-generating process, the predictions that our model generates are also going to be incorrect. Although robust methods have their uses, they don’t fix this issue and can sometimes make it worse by limiting predictions to the central portion of the distribution.</p>
<p>By assuming an alternative data generating process, we can model skewed distributions and make more accurate predictions for <em>all</em> the individuals from the distribution. In this section we’re going to introduce the <strong>Gamma</strong> distributional family for modelling positively skewed distributions.</p>
<p>We’ll be using the same <a href="01_gzlms.html#scenario-gzlms">scenario</a>, so go back and remind yourself if you need to. If you started a new document for this section, you will also need to re-read the data and the packages:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(easystats)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>belay_tib <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/climbing_data.csv"</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  readr<span class="sc">::</span><span class="fu">read_csv</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="gamma-models" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="gamma-models"><span class="header-section-number">1.1</span> Gamma models</h2>
<p>Gamma models are used for modelling right skewed distributions. That is, skewed distributions with the tail on the right side. Unlike Gaussian distributions, which are defined by the mean and the standard deviation, Gamma distributions are defined by <em>shape</em> and <em>scale</em> parameters. These parameters define the extent of skewness and the length of tails, but how shape and scale work together to create a distribution is a little less intuitive than mean and SD in a normal distribution. So let’s have a look:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="annotated-cell-2"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><a class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-2-1" class="code-annotation-target"><a href="#annotated-cell-2-1" aria-hidden="true" tabindex="-1"></a>gamma_dist <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="at">n =</span> <span class="dv">10000</span>, <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">scale =</span> <span class="dv">1</span>)</span>
<span id="annotated-cell-2-2"><a href="#annotated-cell-2-2" aria-hidden="true" tabindex="-1"></a></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-2-3" class="code-annotation-target"><a href="#annotated-cell-2-3" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="cn">NULL</span>, <span class="fu">aes</span>(<span class="at">x =</span> gamma_dist)) <span class="sc">+</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-2-4" class="code-annotation-target"><a href="#annotated-cell-2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-2" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="1" data-code-annotation="1">Generate a gamma distribution. We’re generating 1000 data points <code>n = 1000</code>. We’re also setting both the <code>shape</code> and <code>scale</code> to be equal to 1. Save the result to the object called <code>gamma_dist</code></span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="3" data-code-annotation="2">Initialise a ggplot. <code>gamma_dist</code> is just a vector of numbers, not a dataset. So we set the <code>data</code> argument to <code>NULL</code>, and we use <code>gamma_dist</code> on the x axis.</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="4" data-code-annotation="3">Add a density plot to show the distribution.</span>
</dd>
</dl>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="01a_gzlms_skewed_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Shape and scale of 1 generate a very skewed distribution with a long right tail. How about changing the scale to 2?</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>gamma_dist <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="at">n =</span> <span class="dv">10000</span>, <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">scale =</span> <span class="dv">2</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="cn">NULL</span>, <span class="fu">aes</span>(<span class="at">x =</span> gamma_dist)) <span class="sc">+</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="01a_gzlms_skewed_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>If we change the scale, the tail becomes even longer and the distribution is more pointy. What if we change scale back to 1 and this time set shape to 2?</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>gamma_dist <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="at">n =</span> <span class="dv">10000</span>, <span class="at">shape =</span> <span class="dv">2</span>, <span class="at">scale =</span> <span class="dv">1</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="cn">NULL</span>, <span class="fu">aes</span>(<span class="at">x =</span> gamma_dist)) <span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="01a_gzlms_skewed_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The mass of the distribution has slightly shifted to the right. There is a lot of flexibility in the kinds of distributions that can be modelled under the Gamma family, which makes it incredibly useful and broadly applicable.</p>
<section id="data-visualisation" class="level3">
<h3 class="anchored" data-anchor-id="data-visualisation">Data visualisation</h3>
<p>We’re going to recreate <a href="01_gzlms.html#fig-gzlms-h1" class="quarto-xref">Figure&nbsp;<span>1</span></a>, but this time, we’re also adding the prediction line for a would-be Gamma model. We do so by including the following line in the ggplot”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>... <span class="sc">+</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"glm"</span>, <span class="at">colour =</span> <span class="st">"darkorange"</span>, <span class="at">fill =</span> <span class="st">"darkorange"</span>, </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> <span class="st">"Gamma"</span>)) <span class="sc">+</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>...</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><p><code>method = "glm"</code>: we change this from “lm” to indicate that we’re fitting a generalised linear model, not a general linear model.</p></li>
<li><p><code>colour = "darkorange", fill = "darkorange"</code>: these are the same as before, we’re just changing the colour code</p></li>
<li><p><code>linetype = "dashed":</code> optional argument to differentiate the type of the line. This is only needed if we’re showing multiple lines on the plot.</p></li>
<li><p><code>method.args = list(family = "Gamma")</code> - these are the arguments that we want to specify for the method. We can use multiple arguments here, so we wrap everything in the <code>list</code> function. Inside the <code>list</code> function, we specify that the <code>family</code> we’re using to construct the line is <code>"Gamma"</code>.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>belay_tib <span class="sc">|&gt;</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">data =</span> _, <span class="fu">aes</span>(<span class="at">x =</span> climbing_exp, <span class="at">y =</span> reaction_time)) <span class="sc">+</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">colour =</span> <span class="st">"yellowgreen"</span>) <span class="sc">+</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">colour =</span> <span class="st">"steelblue"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span> </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"glm"</span>, </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">"darkorange"</span>, <span class="at">fill =</span> <span class="st">"darkorange"</span>, </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> <span class="st">"Gamma"</span>)) <span class="sc">+</span> </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1030.5</span>)) <span class="sc">+</span> </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Belayer's climbing experience (in years)"</span>, <span class="at">y =</span> <span class="st">"Reaction time (ms) to break the fall"</span>) <span class="sc">+</span> </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-gamma-h1" class="quarto-float quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gamma-h1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="01a_gzlms_skewed_files/figure-html/fig-gamma-h1-1.png" id="fig-gamma-h1" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-gamma-h1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.1
</figcaption>
</figure>
</div>
</div>
</div>
<p>We’re keeping the original straight line on the plot just for comparison but though we wouldn’t usually do this if we’re just fitting a Gamma model.</p>
<p>Two things to note here:</p>
<ul>
<li><p><strong>Prediction</strong>: The dashed line (the Gamma model) is better able to predict the cases on the left end of the distribution by tilting upwards. Likewise, the line becomes less steep towards the right end, suggesting it won’t go on downwards forever.</p></li>
<li><p><strong>Non-linear relationship</strong>: The line is not straight - the rate of change (the slope) is different in different sections of the plot. This could be a problem for a General Linear Model, but Generalised Linear Models have an in-built way way of modelling this.</p></li>
</ul>
</section>
<section id="link-functions" class="level3">
<h3 class="anchored" data-anchor-id="link-functions">Link functions</h3>
<p>Gaussian models assume that the conditional distribution of the outcome is normal. Normal distribution is unbound - it ranges from <span class="math inline">\(-\infty\)</span> to <span class="math inline">\(+\infty\)</span> , which makes it possible and convenient to fit straight lines that also go from <span class="math inline">\(-\infty\)</span> to <span class="math inline">\(+\infty\)</span> (see section <a href="01_gzlms.html#sec-going-beyond-the-data">Going Beyond the data</a>). The slope of this line is fixed, which means that we’re able to describe the relationship between two variables with just one parameter estimate. The problem is that many distributions we encounter in real life are bound on one end or both and might not be symmetrical. For example the Gamma distribution can only ever contain positive values (i.e.&nbsp;values greater than 0), so fitting a line that extends to infinity just won’t do. But we still want a single parameter with which to test our hypothesis.</p>
<p>Enter <strong>link functions</strong>. They are functions that we apply to the <a href="01_gzlms.html#sec-conditional-distributions">conditional outcome distribution</a> so that we can express the relationship between the outcome and the predictor as a linear term, such that:</p>
<p><span class="math display">\[
g\{E(Y_i)\} = \beta_0 + \beta_1X_i
\]</span></p>
<p>Here, the expected<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> conditional value of the outcome <span class="math inline">\(E(Y_i)\)</span> at given value of the predictor X is transformed by some (for now unspecified) function <span class="math inline">\(g\)</span> . Because of this transformation, a linear combination of the intercept <span class="math inline">\(\beta_0\)</span> , the slope <span class="math inline">\(\beta_1\)</span> and the value of the predictor <span class="math inline">\(X\)</span> can be used to make predictions.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Watch out! We are <em>not</em> transforming the outcome.
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Sometimes researchers will attempt to transform the raw outcome variable in an attempt to “fix” skewness and then fit a regular GLM (using OLS estimation). In effect, they move the transformation to an earlier step:</p>
<p><span class="math display">\[
E(g(Y_i)) = \beta_0 + \beta_1X_i
\]</span></p>
<p>so that the expected value of the transformed outcome <span class="math inline">\(Y_i\)</span> can be predicted from the linear term. This is a bad idea an <em>not</em> what we’re doing when we’re applying a link function. The link function is applied to the expected values, not to the raw variable. An OLS model fitted to a transformed variable will not only give inaccurate parameter estimates, but the estimates themselves will be uninterpretable with reference to the variable we originally collected.</p>
<p>The stats behind GzLM are complicated. Conditional distributions are unintuitive to think about and link functions can be confusing. It’s normal to find this stuff difficult. If you only remember one thing from this whole section, then please let it be this:</p>
<p><em>Generalised Linear Models need to apply a transformation somewhere in the process under the hood to make non-linear prediction possible. This is not the same as transforming the raw variables and then fitting a simple linear model.</em></p>
</div>
</div>
</div>
<section id="canonical-link-functions" class="level4">
<h4 class="anchored" data-anchor-id="canonical-link-functions">Canonical link functions</h4>
<p>Different distributions are associated with different link functions that will achieve the linearising transformation described above. We call them “canonical link functions”. We’ll introduce relevant link functions as we learn about different models. For Gamma models, the link function that we need to apply is the <strong>logarithm</strong>, or the “log” function.</p>
</section>
</section>
<section id="fit-the-model" class="level3">
<h3 class="anchored" data-anchor-id="fit-the-model">Fit the model</h3>
<p>Let’s fit our model using the <code>glm</code> function, which we introduced in the section <a href="01_gzlms.html#sec-fitting-gzlm-in-r">Fitting GzLM in R</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>belay_gamma <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  reaction_time <span class="sc">~</span> assisted_break <span class="sc">+</span> climbing_exp <span class="sc">+</span> distracted <span class="sc">+</span> fall_m,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>), </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> belay_tib </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The part of the code that does all the heavy lifting is this: <code>family = Gamma(link = "log")</code> in which we’re asking the function to use the Gamma family and apply the log link function.</p>
</section>
<section id="check-model-assumptions" class="level3">
<h3 class="anchored" data-anchor-id="check-model-assumptions">Check model assumptions</h3>
<p>We can use the same function as before to check for model assumptions. For Gamma models, the output is going to be very similar, but the underlying calculations differ in some instances.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>belay_gamma <span class="sc">|&gt;</span> <span class="fu">check_model</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-gamma-assumptions" class="quarto-float quarto-figure quarto-figure-center anchored" width="768">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gamma-assumptions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="01a_gzlms_skewed_files/figure-html/fig-gamma-assumptions-1.png" id="fig-gamma-assumptions" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-gamma-assumptions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1.2
</figcaption>
</figure>
</div>
</div>
</div>
<ul>
<li><p><strong>Posterior predictive checks</strong> - this is an obvious indicator that the Gamma distribution was a good choice. The simulated predicted values match the observed data much better than they did for an OLS model (<a href="01_gzlms.html#fig-gzlms-h1" class="quarto-xref">Figure&nbsp;<span>1</span></a>).</p></li>
<li><p><strong>Homogeneity of variance</strong> - this plot can be interpreted in the same way as the plot for OLS models. That is, we’re hoping to not see any patterns or curvature, which appears to be the case. The residuals we see plotted, however, are so called “Pearson residuals”, which can be thought of as the differences between the predicted and the observed values adjusted for the variance - the function for variance will differ depending on the distribution we’re working with.</p></li>
<li><p><strong>Influential observations</strong> - there don’t appear to be any influential observations based on the Cook’s distances or Leverage values. Like the previous plot, this plot also shows the Pearson residuals.</p></li>
<li><p><strong>Collinearity</strong> - All VIF values are below 10, suggesting no issues with multi-collinearity.</p></li>
<li><p><strong>Uniformity of residuals</strong> - obviously, we’re not expecting the residuals to be normally distributed, so that’s not what we’re checking here. What we are checking is whether the residuals follow a <em>uniform</em> distribution - if the the dots are following the diagonal line closely, the residuals are uniformly distributed. The residuals on this plot are, again, not the differences between the predicted and the observed values, nor they are Pearson residuals. They are simulated residuals based on making repeated predictions from our model (similar to bootstrapping)</p></li>
</ul>
<p>These assumptions are not assumptions in the same sense as they are for OLS models. In OLS models, if normality or heteroscedasticy are violated, we cannot trust the <em>p</em>-values and confidence intervals because of the maths underlying the standard errors. For GzLM, the underlying logic is a little different. Gamma models do not assume homoscedasticity - quite the opposite. They also don’t assume a uniform distribution for the residuals. But if the specific type of residuals we extracted is uniform, it’s a signal that the model is well specified. All of the model checks above are just that - they check whether the model we have assumed (i.e.&nbsp;the Gamma model) makes sense given the data. For all intents and purposes we do need to check them and take them as seriously as “classic” assumptions, but the reasons for checking are different.</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The depths of residual hell (optional section that will make you sad)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>If the section above reads a bit like “trust me bro”, blame the <code>check_model</code> function (that’s what I do anyway) which hides all of the complicated explanations in exchange for convenience and a fraction of your soul every time you use it. This section explains some of the weirdness with the different types of residuals. You can skip it if you have better things to do. If you don’t have better things to do, I suggest picking up embroidery or climbing.</p>
<p>Still persisting? Very well. Let’s start with the more complicated ones, which is the uniformity of residuals. Like we said above, GzLM doesn’t assume a uniform distribution of the residuals, and it doesn’t assume normal distribution of the residuals. How about Gamma-distributed residuals for Gamma models? Also no - recall that Gamma distribution can only take on positive values. Residuals represent the error in the model prediction, and this error can be positive or negative so a Gamma distribution is impossible for residuals, unless we’ve <em>really</em> misspecified the model.</p>
<p>In a well specified model, roughly about a half of the residuals will be positive a half will be negative (or a half of the points will be above the line and half will be below the line, as in <a href="#fig-gamma-h1" class="quarto-xref">Figure&nbsp;<span>1.1</span></a>). This of course doesn’t allow us to place any expectations on the shape of the distribution other than that it will be symmetrical and centred around zero.</p>
<p>The check for uniform residuals turbo-charges this idea by running simulations based on our model. R has an in-built <code>simulate</code> function that can be applied to any compatible model to generate predictions. For example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>simulated_predictions <span class="ot">&lt;-</span> <span class="fu">simulate</span>(belay_gamma, <span class="at">nsim =</span> <span class="dv">10</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>simulated_predictions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-cc48b0b593d320d90864" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-cc48b0b593d320d90864">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152"],[925.2040888582046,346.741721130762,465.9629502564255,423.0678802481099,503.1140103717588,560.2954933612446,674.9340276506356,374.8713586500173,401.1648261335233,395.8853220287573,529.0741036844779,416.0414821377931,356.3218683950275,704.0802563696571,573.4646196468327,787.8410352484037,422.0511632712507,473.6970201695906,788.7024485772104,406.2929255017121,426.5591106582759,422.9462229187739,427.3356766964279,623.9888608479531,655.7859472876046,527.6255463595478,473.5201358310002,779.3830220506868,702.4436196115855,661.9094707346048,605.5166996624879,585.9232693685228,702.4186733842621,398.8620176660713,550.0284249700462,419.624493141351,495.7786298342782,572.136411879992,818.9713468515471,858.1439346763325,725.5840814647154,454.2375860334718,590.6325447415185,320.0747176823808,501.3770805412189,303.857543406967,442.9655850902827,445.8946429008192,714.6521433993385,375.0938210209523,705.7376886632886,699.6997868993755,793.8777746747431,329.1550781771488,272.2603094666854,338.3872659038541,632.0738165776327,442.8759218897982,649.6885965836565,508.4202487650041,526.4309046780769,509.0319372684043,498.9691743739613,337.6807359784593,628.1897256704073,588.3234454510024,651.6362100116684,668.7521317710487,842.0176147603187,515.1329179092708,334.3456313752808,480.0556120558389,618.9273877936495,297.2522595882947,738.9381378445687,524.9328556886041,628.2336149832213,369.9915385343893,400.6660481521325,597.520219640858,458.0376413986054,514.0042555478542,612.2090346660764,601.9658437440021,414.8141727981538,440.1093288298745,681.7380044343223,374.1056484648711,458.371520170904,458.1636244542727,399.4045262877215,431.3199786369765,838.1097833040485,422.8056369389965,648.4664234620407,421.5472713054617,591.0414290123699,596.3931458033982,543.3277750638515,659.3244147811976,600.7323694210988,421.286730422645,466.6094155835182,379.8753343468753,516.1971789660794,606.5912647534503,370.1048248270803,400.9395525185483,553.6300024443797,566.7640896015923,431.3266338057484,623.0361780253107,460.9721185418982,306.3435336862298,377.5684154152352,471.4541625298651,443.0546268670143,638.3522924871171,505.3887701721201,499.6252599791578,368.7842571224235,385.9873612770443,699.3901098799167,367.0576076765009,505.5676044573163,605.5522319542193,258.5071965033862,934.4344910394177,393.4334017738842,485.048242576121,544.554319305142,551.8722708955651,541.5977711570737,579.5295101491806,479.4693204057355,445.5650974421145,493.358814697879,548.0057852020786,435.4565519831628,440.8908092092047,581.5922792266111,493.5503946736279,612.9055395000264,597.8000860224973,443.0921142690415,424.7493971151169,633.2684969959439,602.0028205865699,504.8041922241406,483.0357295737005,467.6531294372017,424.8816168786563],[922.1767349623711,447.3171989308597,388.3625516190628,306.532908794039,633.3437689514979,459.5079389903428,539.5330015467151,770.7208801589761,369.7223404092591,517.4908055732183,694.3047419414141,678.5547762565238,477.9517952395951,609.8055552536318,424.7633772904547,568.3159241312602,395.883686671657,556.3074036436483,730.7902766981429,478.6918057101236,347.3007458240957,372.6263075444163,586.4652633711518,622.3515293486025,508.0395365721192,684.1376744776486,455.8115140696152,1010.933400491502,523.0087995549225,400.2982962954701,414.5087586843612,573.8572510835917,667.1776014882835,413.2694775925684,540.2452917664742,424.9823684120521,486.0718743355582,390.8891200386021,827.6799060197127,724.1151243969805,585.3814183511747,492.268049953642,629.3435600965636,552.9056491860666,387.7796622023075,266.1723130622391,408.0710647641221,588.8950147507404,540.1317924839517,489.6797789038762,402.8362972364159,641.0922835678438,729.1248686332013,609.3644293245389,418.6678391043212,418.7104287152511,685.9129491391074,406.7258231120081,777.6142549802507,557.3884394274403,454.6242625834152,454.1137746948409,475.1113667939159,437.9278278280917,854.2837786269454,655.9822860614396,576.2691635642044,515.3398398656295,596.8346377244781,916.1847755594783,357.348406772357,439.6920638102518,755.1197393110804,394.1099660602745,491.224753014252,491.7382932606458,564.4960054104962,374.5521413417981,336.519591129475,470.8254440782729,641.8533230960452,376.1489745148253,676.258073478921,582.9229511064577,447.0809286610763,387.8500985342337,662.9239859645719,373.8240977614909,371.8409904426441,626.3594614007421,582.27242743484,487.7722547438372,730.7938169321959,393.950726702149,384.7224453502216,278.1711987576965,752.0379893914305,686.18682775553,757.8530184071615,680.6918898445956,487.717000606811,538.4477623035535,712.0934021612417,464.1273414725532,630.3257976304332,444.3251336345318,403.3036835944606,416.6199061908702,689.2655821818173,655.8013334844633,309.2673230658507,616.8148815973158,605.4763398655882,348.2311058930281,348.4260453632489,613.0119993635583,513.60780843707,455.9415654826813,558.4807056022478,565.6983266325894,483.0786871740166,552.5390783324021,597.9326724622005,369.5823190204641,487.9907017490861,768.1446008198625,318.9697304456054,750.9294528908923,404.9456313339867,652.679337580946,517.9063250818296,467.8121390697527,584.1939148803424,577.5011744690228,491.8172720036345,548.7793005088054,335.6227466081979,436.5459651831574,492.5086536171486,529.8020718797866,430.3542377008126,628.5393926155881,624.2684541482316,601.7794931703017,521.9199582549153,475.4522420183985,502.1823011962048,557.5931466731092,473.1177840980923,519.717785297453,442.2422880966186,344.8324348047576],[1071.535437395634,408.1957628902616,421.7629820188428,475.3279670819279,308.3194861597277,571.773014559874,609.1748120654004,445.2033104288604,501.7620143204746,385.9170307957348,648.2192920466612,772.0410647605288,591.2469385666813,696.6269194934903,437.947644740552,643.3327259120362,415.1469591244589,466.4445463225708,854.6367685528589,456.3801900883461,408.9928320173416,488.2139667880979,477.9795094845579,733.227401695705,558.4027328947993,719.4314232989457,479.3809994378081,1108.113843298878,570.2622702175573,411.5809676363741,550.5458242150426,733.6295323943684,544.0100625722995,425.7038824874586,561.7134120996457,636.6815890860956,443.0256685996295,498.5222371745888,615.3166229455641,767.2504462939301,539.8884859305304,340.8995659038443,680.9867145076075,336.2426441619214,522.7251481863103,328.4168548588167,579.1563886161465,510.4291137766546,520.9255112087729,464.1704100027292,316.039914528132,620.0361175482664,583.6648433471751,531.2552589567972,484.4881959444011,452.5830058747528,496.8918068986778,279.8328561762224,684.9327013898919,325.7818421230161,498.5196302489923,527.0872559139299,462.9348798847939,313.7645619679255,432.8514768886257,639.6087163239242,491.4611053727826,456.3238704032908,779.2378438757999,615.9432920983118,354.2283158402784,534.1593853235288,566.8913412356798,469.5738896237627,564.9793779789428,721.0307336324795,583.2365486928825,315.0194770953423,401.5187537231985,600.1670955066215,616.5835865029263,402.8980138582784,649.2553360784568,782.9875600065404,504.021012342784,391.2386749464803,465.7322947325423,389.2672381485506,346.4119579516447,500.1817029965727,503.487511081718,426.2593824640889,567.975476933369,574.9533562707903,545.3271676113493,312.7389178875441,589.5351192670776,637.1705841035997,801.1249940464492,639.5355715601013,578.1891366115448,479.6971446919091,557.0567063970769,401.4809927749724,605.3763892526251,399.5411923964609,459.7245295172451,394.3278832848745,520.3651393351477,681.396390864059,388.9386840572685,455.0762140009444,343.4876673425845,321.4656339704685,706.3202721292395,458.3670360531531,508.2703389642843,401.5464961802029,573.7950196673261,387.7618833557071,381.7111550244094,464.0960841164254,510.3439166839544,379.146868044098,404.579333270761,423.3900811496396,514.6766222905073,861.1816781024953,465.1888659670813,508.6450666788127,350.5249604143648,786.5768489870029,429.606415503414,569.2161731398803,467.1946857698202,534.8759775694925,375.523007636068,469.1607810542616,514.4471444003175,705.4153753962723,497.5021816651997,558.490385845858,495.5765955931385,491.7344609670961,759.911686870667,482.9791853707062,636.0107009806843,494.4326340972925,535.5460659649993,485.1127335119758,440.3137476502262,354.1628134710342],[787.2948531786758,301.2644131746315,391.5424160280154,361.7008827201201,606.1697517982827,390.5954528719739,778.8788730050663,426.0528213021857,485.5944520853284,437.7427512048282,528.6463272558309,796.8123451985721,479.9793987487673,747.3977342796767,578.6840597236719,666.8649344551068,381.1974875882051,348.3551504958683,749.699204377062,708.7218304854182,402.1034221707379,378.7535417552425,482.7770591210742,537.815570012834,580.1765701647109,549.9158946880412,670.5775059370355,707.2429150727936,594.6139602000776,480.720628251859,567.6131914696971,610.9544833339532,662.6308510779744,342.1672352964363,478.9999268102291,530.9607261027315,421.0146090655543,425.0721302857413,567.9548503283413,680.8208922098319,577.8610294900379,441.2788347437079,668.3168297831584,461.0742361428549,503.2937135658392,266.0679560715171,470.7025022070264,463.5106855306498,693.294185845395,686.4238623699156,484.5479465708273,501.4538259782676,655.4117234370335,717.0991362295276,464.3288981222077,432.4735725926599,597.9726119638005,486.8564623296879,743.5418401980759,462.4833691190789,569.4896166740308,462.8763138624504,449.8219724601488,357.3941325179854,720.8419009842451,553.8977534492915,706.8161660662256,553.1365567188692,636.9319534949099,720.7882737241962,319.2227289758808,421.9025049433162,606.5742338321105,276.1858756711377,430.6296000282883,669.3622914393599,595.1035007372344,429.6798521571961,459.9627582399457,376.5930240199021,712.3287495211695,500.6597768243756,510.0298771612402,858.090948642852,504.2207829333741,622.7623351535347,535.9761668494042,514.5686706336523,366.6726317684053,357.7118964199826,485.3011980154828,446.6491135257742,510.420992704195,490.9472794551762,467.2861364070647,340.3913386009302,699.8296788600351,705.3424661502396,617.6922535354711,811.9461176504716,453.3290817573289,437.7524288959486,742.4009228764448,453.1620933877945,544.8972481881901,554.8455120552837,587.3214697653655,480.1905029363114,491.5890811533058,788.7438217698542,331.0177716075063,542.2714233588571,477.1533323886691,223.8422922948323,403.0652275083788,575.9922473459792,455.2693613510162,568.480602835401,513.2723832298,515.9335369400611,504.8325123499167,615.5759759917146,579.7028593953279,621.6853994696347,525.730398382385,472.911845469353,645.5385094338516,650.2359615044076,525.3667541453354,638.4012445284548,433.6506114167477,667.3203722797683,549.4021139022743,535.2838296823808,402.6749339748129,438.5785738459451,417.5164226976007,427.3979280646249,382.1369762635885,680.5108855647323,589.0041100561019,667.2738662745709,662.9844685616157,828.531286787446,592.8206679268898,447.4267958709301,610.8249670952046,433.3148500029322,598.8586694417749,342.4331671494649,533.6271955699563,332.7631718255361],[648.3639491463135,445.7274644960085,465.6213167501013,298.230551217657,373.5033906616758,433.0859920963607,615.6256334377739,530.1616575523313,399.3057610426003,493.3584387841778,494.1400496516933,721.6131705832956,564.8245294017916,702.5926711456473,552.5842876391748,612.2244923526312,429.520888792694,523.4708450778426,560.646882832228,542.3241150012879,403.6731160187877,452.8426566341741,450.6538185616553,716.3992281134703,666.3909588452993,473.3919297381329,620.7310115043049,602.31717366677,406.0214506325764,377.0417093752411,471.4768024453962,634.5927673095413,627.5894096017764,331.0465558519099,619.0017854557242,487.1584355819734,468.4759252323352,643.7488931192113,565.2344628369539,690.5078675903467,446.1652065622804,362.9399289776944,678.736499195649,407.7668133591929,358.1429553512654,219.1841099554559,454.8323687579828,510.1073395375678,592.9560487529864,584.4284016536321,633.1254497891724,692.8359885765789,533.1902479118486,510.6809856863653,430.4314823858995,476.8478032842766,739.0563170004303,358.6075904085536,520.070719279073,632.9687207887268,509.9118023518026,442.7595946503915,491.7772610056679,545.269779424291,825.1243472272569,710.9660222877191,1018.071081394125,500.3981404809763,506.689915324543,696.9818406859433,379.8445423698358,534.5251986118476,770.9605570564579,368.7212086465856,672.8038138982477,529.9799538633579,616.4987451340492,363.5483266089504,332.3256213098101,513.5002751493108,526.3314720218475,351.0756344500361,459.9148171240493,941.4609313759991,415.0215381008148,368.5493650745187,768.4046485722889,447.6052311373085,435.4679604258609,535.5885802954131,551.5364035916573,599.5521023140922,508.9834160742753,546.9907296411573,440.2267957723516,411.5552016071713,588.4336642386739,732.3412360265622,709.068111018216,632.9804843904701,542.0857716334923,388.0128959503243,717.2830908616137,367.9181053834524,478.9814242600575,604.7316985844765,368.1545129284754,432.6786978769002,694.2225673118546,952.3643849977924,485.9642287678346,347.7135022974795,613.5339227157027,330.0344300957088,477.2946464623128,384.8623711117049,561.52391001221,441.1974071355633,601.2881475879695,516.4208109806422,641.282569071997,408.3315367191211,502.7015699435246,462.8472219415443,571.9792615388698,687.3517908004959,441.5225074779737,777.8286717502863,390.48961674293,493.7785489429539,404.4431255369025,508.074940075648,562.4853811089964,446.5468489165218,476.3206067765499,530.0892957393996,301.438374778409,487.9585929238065,416.3404536535592,409.3845345733852,483.263903149977,546.5235764007895,600.35954494788,481.3016865544611,733.0322317687851,492.9505241241864,363.7175860000198,553.1388655089615,490.3891490702354,315.0238876305809,699.1083937588339,465.0639855431807],[581.1332167642388,282.8658548360718,344.9986696858625,341.385918923617,625.5524140146458,364.4867033331943,687.3602306380809,404.0260108678965,569.3786020838703,476.8898056611862,612.1936801415281,799.2128328372221,430.2377086014658,643.7958388967966,415.7517087031611,496.9759185176979,352.099417689376,463.0646253111119,481.6524686507133,646.591231846132,427.9764390208484,427.6160788277809,462.4616310853384,528.7764658177249,650.867749901339,401.0776380663311,662.7104542378024,814.0895903685316,708.1037968712533,548.1905014193553,529.5439030837188,497.7049060224927,488.2403539408927,350.6636063836306,552.4465063645453,536.7027426190435,381.0520945005042,423.0598245948797,664.8557461417683,605.8587694480763,631.7390672472602,315.999613700908,869.274416635575,238.9346676960662,351.4980527801541,273.5825657866695,339.8644002006845,431.4417426337808,523.8271703497455,442.0701486695411,580.0420989320278,464.4083760147255,413.546926980376,598.2412201144866,419.8841655124188,501.6295601961617,580.0406416139531,310.0957851195313,769.6709039453399,465.748922814929,377.4960560194402,415.6582200198137,373.6686444451277,474.8939962761697,769.9880170628039,592.8409739001386,676.7633731221559,562.3302300625156,605.3887687393866,753.1172452153071,452.066512184592,571.9729775560002,728.2424350548235,335.8563957345795,617.2325530445229,353.63126819504,756.2763233072262,495.7370610809976,424.8128045548279,532.784982622495,565.0213188923592,483.9557889408484,525.2207800117136,679.6327950446926,389.298144819716,380.3885713670603,539.2940531533752,347.4672948941131,376.5143377999337,641.3299716156886,467.935854561483,411.1040791123099,692.7744889380682,525.3374068980035,417.0759953348374,495.9674803888584,535.1731178093194,699.4171224769441,588.6093605518971,527.2410407530388,381.4986875819829,528.2313659702302,702.4321404747549,303.7138332506708,430.7019856332754,677.8847548841505,542.9550799033565,442.6717102165857,382.0150113093707,932.6874739290668,390.6361774392189,525.5558192237702,385.3620989117856,396.5807383186471,707.1334104965337,407.7338126629678,456.2930362720028,422.717671523324,361.325103985504,441.3190767195497,556.3665674611113,476.0100948588587,522.0426739276614,337.1488952238656,445.9149336225376,765.7730733703006,461.4096896297243,630.7802430719257,389.3581059538298,576.4886700802559,333.8848152727161,673.7975560408255,527.7309155112191,543.383784201837,415.9163317456041,591.4880893529123,371.6837531724769,521.7744451312701,398.8178562000695,521.9175319505349,658.0688694564425,537.1721040345832,542.0902200681689,592.2359937005006,673.234593174401,590.9070854189202,512.477001517075,534.0343063519385,519.3184365853474,498.5842708843265,449.3233378175422,399.0625247196448],[837.1130721292858,328.5120519694909,418.2765764485553,245.472667985078,496.2763379867875,513.4254925498556,900.1273238070462,487.8880960517974,477.0303798075547,373.9624625447189,505.1731787159667,683.7966850925856,452.0458971098111,548.1159495134756,664.641627763835,728.8666817212736,529.3554051713304,584.6981871048038,715.819467608265,472.5723542389266,522.0383848262913,434.899317695657,576.7089008328882,525.6416366538832,523.7292544730548,573.3552127657464,544.4507387659336,642.8790238678864,401.4069060563738,416.7046157033093,485.5009394487268,554.6439822384476,617.2987726352198,527.4413944651633,479.0824515023227,494.0522584000888,441.9875486984382,576.7358229453913,840.6359478226506,560.7919074443918,386.2227575845447,344.6581540407421,703.7835905166838,423.1749955331454,405.1042225975565,361.7482814317087,411.5737636193689,565.0318366042554,466.1113725540733,421.2831512053866,487.6577990235406,495.877436578734,552.1310249985282,484.8810323366354,388.1175184102567,514.8157771180821,557.270000639276,370.5566353729194,938.7733221446305,602.075495821162,482.7313267483297,473.6296476427403,599.9019199441882,428.2022113605178,750.4783343602836,705.0988253571703,530.4686352305,480.6927327162184,628.3246822153581,638.0280325782147,389.7667857211163,428.5818222598047,639.4938225838384,323.4644966429779,482.2967514101044,584.9894319443174,625.7086548536472,473.1011546194921,397.3778762077156,644.0839943195563,496.2969009706876,463.0379383780329,549.2828915170463,589.1562787357356,567.4825434134893,466.8956238329725,498.7355434631282,332.4819181249678,422.6173118985554,563.2347329343676,464.7325229510805,585.5629911111563,495.3633651017229,526.3273566198586,416.6352096076605,325.9286176668674,630.4080302252773,648.6443095242638,733.9285042447821,575.6229573118296,556.2074570260119,625.3994414199524,642.4525283215189,399.7580448139463,497.3980142713296,433.4010388172084,590.1944358782514,479.5585935293348,640.6425396597407,757.2010692137767,390.217709507601,897.2559911690269,523.0371597194192,264.7960793248967,532.1573951827194,457.5575429771139,531.4304317655751,657.3332504574129,396.2892995158037,465.654321856172,425.7050736465356,544.6206583551472,495.0687502453065,494.2415560865171,501.879500189576,406.4123624288609,591.077111399949,752.8610118100696,467.7567445439008,445.2274578711426,421.8087596633467,394.7627908204799,843.2234096505608,530.3169974507445,381.2219333680759,467.981760705326,319.4754545830074,356.1015339305471,352.9988489979955,677.0815352367739,472.45527876022,442.8835348116671,495.839829005286,563.5809376348868,625.968145070183,465.0425066371054,538.5078065070045,517.3045582893992,433.0645574629167,310.5674687333408,429.4377301385963,405.650624388518],[909.886153255233,426.643478549255,289.2004277738381,297.4916944127114,647.7028168809268,457.2725580278547,478.3845810969186,534.7764178855234,405.4925625831966,456.0180366244953,658.3397191080755,684.9086403109849,435.5409995502749,631.3007459229581,568.696433502224,605.9653653265618,291.7600083208613,451.8166765699177,999.3139024910652,603.7671509250401,535.9692138035315,417.0129470684664,546.2760160516455,528.8335800936563,523.1554830878794,427.9877516438788,541.7255992884268,592.5891937823262,420.9271382178853,592.6826551056491,443.711941431428,434.8665688538645,515.5170493178898,415.5551431549187,386.9325641234163,532.0186314101031,309.3536249117614,636.8452811186935,602.7136076618036,513.8470162324683,419.9591843609364,497.8768859254563,536.2597756397635,554.5847906552614,340.123862476385,333.2437535686789,398.4428246882387,485.8405579878482,574.4815485559085,500.2564089750068,555.6226861979155,503.3439506913589,791.1024917356356,498.2970448360979,387.2537939564248,450.8576559223152,509.9242290125329,410.3080157638264,753.0138725037381,535.124903517454,611.3444153941925,523.7021494511328,382.9156661064419,556.6096091122105,554.3353294126421,977.3090231149325,928.9611226233511,372.556432605627,715.6225740217607,539.4444105963705,325.9544254444885,347.0932166295783,669.625485222102,278.1682867458765,424.3290416168703,563.4150223189746,581.9258582428458,488.4607492710667,356.0742671952662,457.8290805849363,537.5284356633048,496.6665550687911,551.6681530905221,584.1521878508771,381.0816501987234,431.0144708011719,523.3077827040385,427.6491718822717,387.462576678249,607.8597316399018,635.052509501665,562.3142231511439,638.0100872082545,430.7842852003009,526.9788955315469,327.8376481298332,746.5430063329509,597.6712668387046,777.0316786186189,588.8246928067476,429.323487602133,392.1976019297797,495.6248471288155,395.275429090467,567.7131586380609,605.6345428381039,428.0879765865051,415.1914225465152,589.4361153249672,649.116635627817,372.5425514470351,566.5391810554567,470.972908231096,313.1771565730747,599.3389203489555,582.3409194456059,517.6366582675183,461.4226008999562,455.0161585634398,468.2485980663164,595.3496390301235,432.7738911762367,442.4857642175088,542.6463430595246,366.1774394223758,534.6821950713517,503.9082509283019,655.528382502677,514.5606581620877,542.7006401923088,520.8580383343482,639.3375840358505,484.7524483762711,545.582315968271,439.7543280351102,432.3493848302159,385.8723022537931,511.6740005694419,490.0035557573843,710.5414092455923,562.9890226820044,567.1971292757028,494.0101402609653,607.2641103907985,738.8581679798198,557.9171408939968,740.8504985667545,471.310873777336,427.1268156809347,501.947679921004,433.4303202432249,449.7296284182756],[728.1312725626052,357.0564471935938,503.3057259230193,267.1987076013538,230.3454260886992,547.9703578578223,369.2339104518142,372.2318649371599,473.9107542016466,347.6193538446312,608.3297923426394,659.0549116913259,659.7176405062874,730.8597485585477,463.1788678918967,487.7671094432873,397.7907895409341,434.1768491669209,728.7127418681073,487.1332171119116,422.0608806939699,452.577640731114,386.5903734440249,643.5211284288841,428.4838362847122,393.2447614685335,406.8442778808095,782.9890356362159,432.8390656635395,662.0594118215361,596.3619482817703,606.4407898698498,744.1081312614688,368.9148533796504,334.8994020589458,456.0336099911179,420.668350868521,469.8549829259163,544.4239156433433,882.940463458582,429.5755991211954,469.4500269259372,581.0526426402519,232.5373413656082,426.1040026403745,366.2575069616236,451.9337492872277,374.863944309685,595.6567979267584,394.5201377231454,531.3344338149128,626.216714233091,616.0923300349111,580.3824429165254,431.6724232903601,442.2985131988019,726.4228684093214,545.7659153264594,699.4107488378729,534.510592725007,647.851733364142,515.04501705353,496.265041719373,535.3408875099881,560.2224606021199,479.8730051578056,601.4047512026109,595.0875095668097,702.1974252459192,653.0347470844433,284.6918656516038,425.2442161013926,587.4776991273766,344.5138465998285,691.6560008439956,667.1131279820157,446.0080459033997,303.358020784937,375.0970372251158,517.2448793440697,527.0843191787466,377.9991980951641,563.1448842753563,609.7943200555966,408.8089449107273,388.5696606001695,341.5649530750864,426.1931722004852,321.0763197289225,607.5787574960539,360.4122260972224,801.8070697840636,579.1618326449808,471.2101993967601,528.8024134025428,511.1789500960656,572.4347406320752,598.7828301473942,804.3490776396553,813.073227208673,489.8863475052395,520.2342433763635,622.0327645409653,404.0096645194193,646.9927883021563,433.0381153034281,447.4430581862139,337.7230048356647,604.7203714370685,809.5132697347254,400.2636905268955,554.3401284122393,347.9817893568727,210.2307419763806,388.1565795831568,633.5618422762847,379.2941686870975,536.2869525280004,541.2494389008982,446.183623944865,624.2129816033339,424.7285046749532,543.145350646526,464.2807352627822,635.0423837404962,648.4329956794991,546.2394014856789,837.8601366734158,668.1652821081223,559.5763454868282,613.8673935599941,519.6398931245382,512.1224559039204,437.4257694066775,501.5224971641827,485.4077212362462,392.5399166809947,470.7220518364398,369.1815423531864,506.7188319973202,696.0043338130279,379.6652608598571,457.6751531339651,376.7833173873544,699.2019735158638,461.4092429448967,636.8337574071422,427.8722028131774,540.4193457217307,559.4024572400601,306.8352977671236,408.7254984999337],[969.0829982810216,353.5864152697318,363.7904081694249,389.9592340561825,417.0630783266308,493.5814524633766,723.5933551454989,403.6585662876146,599.2607439218891,481.5771114809201,572.1866219486209,657.721240940302,589.5294776944245,532.9050922007663,446.3235998743735,425.0181574185477,415.6182133784538,344.0110039973591,841.366678188259,442.5579005330615,492.4363505286731,462.1616801783565,510.1434516588992,678.6953574531684,618.7023479250643,363.8501050423963,589.5899205463367,890.1935204157118,607.6767288923871,497.3869425009597,554.6734156052736,521.6719247571697,542.397925060582,446.1791141635885,564.5745819483558,489.8012981604558,332.6131938747869,517.034751882468,807.5062084510063,727.0919830740393,523.9138845088296,429.5154740507868,645.8048646929884,324.7327766656614,353.3618341363767,289.7613247659153,383.6467269035348,475.9641547302475,503.496053924379,549.8960955190732,557.132896349589,534.1950843685987,701.7038610835306,512.3257117006485,466.4734552809183,421.8685949621351,445.1482310392261,482.1314266727689,708.7093038993469,431.5878193753472,369.6417032505908,471.5213655333986,566.823796307347,256.8241481838322,692.9403611221926,702.4553219628707,615.0291407761216,502.487683316238,840.9779053804031,641.5508228783343,345.9324098182173,449.1363236091318,534.7472536205327,471.1257855586355,679.8130637130655,478.9477154276171,554.1546521949685,382.270720459145,346.7245769082247,490.5055844869909,570.4637255229097,417.3283375920709,402.8366721626676,782.737474859496,299.9300279095993,379.8842370009133,609.0189284024545,455.3453464529601,272.1228996820267,529.8259065821768,366.7247396473856,452.669906527516,782.5544890882795,519.5741683340403,492.6227255485338,434.9543419344924,515.1310173697879,422.7644046080518,568.0215236182993,543.437189191407,767.5839883962079,578.2331233642592,524.554325419371,488.0770215994629,604.8580329160984,482.0699396393121,430.5785499849015,470.4070027802264,586.8034644575761,615.2234331253909,353.2423380276894,664.4552482644867,524.9188781523576,250.8427144838097,333.2324747987733,463.4029914443056,420.3140790618061,395.9901189880225,417.5194974009322,474.39738584534,480.4564152186635,438.8449792763127,487.8304799363481,422.0444723765399,569.3037798556373,747.4843933180385,412.7160558340199,444.3340551904486,437.9805233060405,539.5476363156215,498.6405744467231,454.2963430507543,644.3977900229289,551.3055832914137,590.7050631534875,503.895799904366,366.5394538640754,706.6001305856778,318.8694615168589,499.4636645399701,660.0257551777156,435.0831131472021,783.980952657089,868.9631449433185,526.5821981671155,539.0807090995709,715.4667786758836,537.2457459861191,423.1754737822526,587.7427751887325,389.2895707451922,370.78425500996]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>sim_1<\/th>\n      <th>sim_2<\/th>\n      <th>sim_3<\/th>\n      <th>sim_4<\/th>\n      <th>sim_5<\/th>\n      <th>sim_6<\/th>\n      <th>sim_7<\/th>\n      <th>sim_8<\/th>\n      <th>sim_9<\/th>\n      <th>sim_10<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"sim_1","targets":1},{"name":"sim_2","targets":2},{"name":"sim_3","targets":3},{"name":"sim_4","targets":4},{"name":"sim_5","targets":5},{"name":"sim_6","targets":6},{"name":"sim_7","targets":7},{"name":"sim_8","targets":8},{"name":"sim_9","targets":9},{"name":"sim_10","targets":10}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>This will take our model 10 times and create 10 sets of new predictions for the value of the outcome (reaction time) based on the model we fitted. Were are the values being draw from? We we request a standard non-easystats-y summary of our model we get this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>belay_gamma <span class="sc">|&gt;</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = reaction_time ~ assisted_break + climbing_exp + 
    distracted + fall_m, family = Gamma(link = "log"), data = belay_tib)

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     6.62505    0.09243  71.674  &lt; 2e-16 ***
assisted_break -0.06913    0.03094  -2.234 0.026965 *  
climbing_exp   -0.11136    0.01052 -10.591  &lt; 2e-16 ***
distracted      0.13151    0.03063   4.294 3.18e-05 ***
fall_m          0.14996    0.03781   3.966 0.000114 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for Gamma family taken to be 0.03501732)

    Null deviance: 9.9564  on 151  degrees of freedom
Residual deviance: 4.7078  on 147  degrees of freedom
AIC: 1809

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<p>Specifically of interest here is this:</p>
<p><code>Dispersion parameter for Gamma family taken to be 0.03501732</code></p>
<p>So the simulation takes the first row of our dataset, considers the values of the predictors and builds a Gamma distribution conditional on the predictors using the “dispersion parameter”. The dispersion parameter is directly related to the scale parameter <span class="math inline">\(\theta\)</span>. Now that we have this distribution, it randomly selects as many predicted values as we requested. In the example above, we set <code>nsim = 10</code> so it selects 10 of them.</p>
<p>Once we have these 10 values, it compares each of them to the <em>actual</em> value of the outcome - again, this will come form our original dataset. The outcome will either be smaller or larger than each predicted value. Let’s stick with the first row:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>belay_tib[<span class="dv">1</span>, ] <span class="sc">|&gt;</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">display</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 11%">
<col style="width: 20%">
<col style="width: 22%">
<col style="width: 16%">
<col style="width: 19%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">subj_id</th>
<th style="text-align: right;">reaction_time</th>
<th style="text-align: right;">assisted_break</th>
<th style="text-align: right;">distracted</th>
<th style="text-align: right;">climbing_exp</th>
<th style="text-align: right;">fall_m</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1017</td>
<td style="text-align: right;">847.40</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.10</td>
<td style="text-align: right;">2.10</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The reaction time for the first row is 847.4. Now let’s look at the values simulated for this first row:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>simulated_predictions[<span class="dv">1</span>, ] <span class="sc">|&gt;</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">display</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 11%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">sim_1</th>
<th style="text-align: left;">sim_2</th>
<th style="text-align: left;">sim_3</th>
<th style="text-align: left;">sim_4</th>
<th style="text-align: left;">sim_5</th>
<th style="text-align: left;">sim_6</th>
<th style="text-align: left;">sim_7</th>
<th style="text-align: left;">sim_8</th>
<th style="text-align: left;">sim_9</th>
<th style="text-align: left;">sim_10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">925.20</td>
<td style="text-align: left;">922.18</td>
<td style="text-align: left;">1071.54</td>
<td style="text-align: left;">787.29</td>
<td style="text-align: left;">648.36</td>
<td style="text-align: left;">581.13</td>
<td style="text-align: left;">837.11</td>
<td style="text-align: left;">909.89</td>
<td style="text-align: left;">728.13</td>
<td style="text-align: left;">969.08</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The outcome value is smaller than 5 of these predictions. If we want this as a proportion, we divide this by the number of simulations, which is 10 and get 0.5 .</p>
<p>We repeat this process for all of the rows. So next we create a distribution conditional on the values of the predictors in the 2nd row of <code>belay_tib</code> and then draw from it, then the 3rd row, 4th row, and so on until we’ve done this for all the rows. The function also draws more than 10 values - the default is 250. At the end of this process, we’ll have a proportion of cases in which the outcome is smaller and larger than the simulated values for each row. So in our case, we’ll have a distribution of 152 proportions. <em>This</em> distribution is then checked against a uniform distribution. If it’s a good enough match, we conclude the model is well specified. I’ve included some code below that demonstrates the whole process to the point of obtaining the final distribution. It’s not annotated, but if you’ve come this far you can have a go at unpicking what each line does.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span>  <span class="dv">250</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>sim_data <span class="ot">&lt;-</span> <span class="fu">simulate</span>(belay_gamma, <span class="at">nsim =</span> nsim)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>sim_data <span class="ot">&lt;-</span> sim_data <span class="sc">|&gt;</span> </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">actual_outcome =</span> belay_tib<span class="sc">$</span>reaction_time</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>sim_data <span class="ot">&lt;-</span> sim_data <span class="sc">|&gt;</span> </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">across</span>(</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">.cols =</span> <span class="sc">-</span>actual_outcome,</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">.fns =</span> \(x) actual_outcome <span class="sc">&lt;</span> x</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> sim_data <span class="sc">|&gt;</span> </span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>actual_outcome) <span class="sc">|&gt;</span> </span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowSums</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>proporions <span class="ot">&lt;-</span> counts <span class="sc">/</span> nsim</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="cn">NULL</span>, <span class="fu">aes</span>(<span class="at">x =</span> proporions)) <span class="sc">+</span> </span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"yellowgreen"</span>, <span class="at">colour =</span> <span class="st">"yellowgreen"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01a_gzlms_skewed_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The distribution above is the one compared against a uniform distribution.</p>
<p>Now onto the issue of heteroscedasticity and Pearson residuals.</p>
<p>You may recall that we talked about how GzLM can model different types of variance between the predicted values and the variance (in the <a href="01_gzlms.html#sec-mean-variance-relationship">Mean-variance relationship section</a>), including heteroscedastic ones. For Gamma models, this relationship is quadratic:</p>
<p><span class="math display">\[
V(Y) = E(Y)^2
\]</span></p>
<p>That is, for each predicted value, the variance is expected to be that value squared. This is clearly the opposite of homoscedasticity so why then are we looking for it in <a href="#fig-gamma-assumptions" class="quarto-xref">Figure&nbsp;<span>1.2</span></a>? That’s because we don’t expect to see heteroscedasticity in <em>Pearson</em> residuals.</p>
<p>Raw residuals - the one we’re used to talking about in OLS models - are calculated as the difference between the actual value and the predicted value of the outcome:</p>
<p><span class="math display">\[
\epsilon^{raw}_i = y_i - \hat\mu_i
\]</span></p>
<p>in which <span class="math inline">\(\hat\mu_i\)</span> is the predicted value. We get extract the raw residuals out of our model if we so wish:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>fitted_values <span class="ot">&lt;-</span> belay_gamma<span class="sc">$</span>fitted.values</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>actual_values <span class="ot">&lt;-</span> belay_tib<span class="sc">$</span>reaction_time</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>raw_residuals <span class="ot">&lt;-</span> fitted_values <span class="sc">-</span> actual_values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now let’s plot them against the fitted values to get the “classic” diagnostic plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="cn">NULL</span>, <span class="fu">aes</span>(<span class="at">x =</span> fitted_values, <span class="at">y =</span> raw_residuals)) <span class="sc">+</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="01a_gzlms_skewed_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Would you look at that! The shape is funneling out, the heteroscedasticity is still there. But checking this plot as a way of diagnosing the Gamma model would tell us nothing of use because the model doesn’t assume the absence of heteroscedasticity.</p>
<p>So we look at the Pearson residuals instead, which are calculated as:</p>
<p><span class="math display">\[
\epsilon^{pearson}_i = \frac{y_i - \hat\mu_i}{\sqrt{V(\hat\mu_i)}}
\]</span></p>
<p>The top of the fraction is the same. The bottom part, specifically the <span class="math inline">\(V\)</span> is the function for calculating variance in a given model, which changes depending on the distribution. This will “model away” the heteroscedsticity, which is why we’re still looking for a random non-funnelling shape when checking the diagnostics.</p>
<p>If you made it this far, well done. This is about the maximum amount of information I’m willing to know about the topic at this stage of my life. There is no more to be learned by asking me clarifying questions, but you can certainly try.</p>
</div>
</div>
</div>
</section>
<section id="check-model-fit" class="level3">
<h3 class="anchored" data-anchor-id="check-model-fit">Check model fit</h3>
<p>As usual, we want:</p>
<ol type="1">
<li>The overall fit statistics</li>
<li>The test of model fit</li>
</ol>
<p>As previously, <code>easystats</code> has our back and we can just use the familiar functions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>belay_gamma <span class="sc">|&gt;</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">performance</span>() <span class="sc">|&gt;</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">display</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-gamma-performance" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl quarto-uncaptioned" id="tbl-gamma-performance-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1.1
</figcaption>
<div aria-describedby="tbl-gamma-performance-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">AIC</th>
<th style="text-align: center;">AICc</th>
<th style="text-align: center;">BIC</th>
<th style="text-align: center;">Nagelkerke’s R2</th>
<th style="text-align: center;">RMSE</th>
<th style="text-align: center;">Sigma</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1809.0</td>
<td style="text-align: center;">1809.6</td>
<td style="text-align: center;">1827.2</td>
<td style="text-align: center;">0.54</td>
<td style="text-align: center;">100.17</td>
<td style="text-align: center;">0.19</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>The main difference here is that instead of typical R<sup>2</sup> we get so called, <strong>Nagelkerke’s R<sup>2</sup></strong> . The R<sup>2</sup> in OLS linear model is based on least squares calculations. In GzLM, the R<sup>2</sup> is based on what we call “deviance”, and because of this, we call it “Pseudo-R<sup>2</sup>” - kind of like R<sup>2</sup> but not quite.</p>
<p>Like R<sup>2</sup> and the F statistic, deviance is a goodness-of-fit measure. In plain language, it tells us how much our model differs from a model that is perfectly defined. A perfectly-defined model is sometimes called a saturated model - it is a model that can predict the outcome without any error whatsoever. In the perfectly-defined model, the deviance would be zero - therefore the less deviance we have, the better.</p>
<p>The <code>performance</code> output doesn’t provide deviance for us, but we can request it easily by asking R to show us the default ugly model output without any additional code:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>belay_gamma <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = reaction_time ~ assisted_break + climbing_exp + 
    distracted + fall_m, family = Gamma(link = "log"), data = belay_tib)

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     6.62505    0.09243  71.674  &lt; 2e-16 ***
assisted_break -0.06913    0.03094  -2.234 0.026965 *  
climbing_exp   -0.11136    0.01052 -10.591  &lt; 2e-16 ***
distracted      0.13151    0.03063   4.294 3.18e-05 ***
fall_m          0.14996    0.03781   3.966 0.000114 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for Gamma family taken to be 0.03501732)

    Null deviance: 9.9564  on 151  degrees of freedom
Residual deviance: 4.7078  on 147  degrees of freedom
AIC: 1809

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<p>At the very bottom, we can see the following:</p>
<ul>
<li><p>Null Deviance: 9.956</p></li>
<li><p>Residual Deviance 4.708</p></li>
</ul>
<p>Null deviance (D<sub>0</sub>) tells us how much deviance there is in a model that doesn’t have any predictors. The residual deviance (D<sub>R</sub>) is the deviance that remains after we’ve added our predictors. We can then calculate the pseudo R<sup>2</sup> as:</p>
<p><span class="math display">\[
R^2_\mbox{pseudo} = 1 - \frac{D_R}{D_0}
\]</span></p>
<p>Of course, once a pseudo R<sup>2</sup> like the one above was defined, statisticians started an arms race about minor modifications to the equation which would estimate the deviance in the model more accurately. Nagelkerke’s R<sup>2</sup> is one of these modifications and generally a good choice. That’s all I will say about it because it is 8pm and I need to deliver this workshop in about a week’s time. Unlike regular R<sup>2</sup> , pseudo-R<sup>2</sup> is not interpreted as the proportion of variance explained, but as proportion of <em>deviance</em> explained by the model, although statisticians like to debate whether attempting to calculate R<sup>2</sup> for ML based models even makes sense in the first place. We’ll leave it at that and use it.</p>
<p>Based on the pseudo R<sup>2</sup> , our model explains 53.53% of total deviance in outcome.</p>
<p>Finally, let’s test the model fit:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>belay_gamma <span class="sc">|&gt;</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">test_wald</span>() <span class="sc">|&gt;</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">display</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>code Only one model was provided, however, at least two are required for
code   comparison.
code   Fitting a null-model as reference now.</code></pre>
</div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Name</th>
<th style="text-align: right;">Model</th>
<th style="text-align: left;">df</th>
<th style="text-align: right;">df_diff</th>
<th style="text-align: right;">F</th>
<th style="text-align: right;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Null model</td>
<td style="text-align: right;">glm</td>
<td style="text-align: left;">151</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Full model</td>
<td style="text-align: right;">glm</td>
<td style="text-align: left;">147</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">40.97</td>
<td style="text-align: right;">&lt; .001</td>
</tr>
</tbody>
</table>
<p>Models were detected as nested (in terms of fixed parameters) and are compared in sequential order.</p>
</div>
</div>
<p><br></p>
<p>Overall the Wald test indicates the model is good fit, <em>F</em>(4,147) = 40.97, <em>p</em> &lt; .001.</p>
</section>
<section id="sec-gamma-params" class="level3">
<h3 class="anchored" data-anchor-id="sec-gamma-params">Parameter estimates</h3>
<p>Finally, let’s extract the parameter estimates:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>belay_gamma <span class="sc">|&gt;</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parameters</span>() <span class="sc">|&gt;</span> </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">display</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 20%">
<col style="width: 21%">
<col style="width: 8%">
<col style="width: 27%">
<col style="width: 10%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: center;">Log-Prevalence</th>
<th style="text-align: center;">SE</th>
<th style="text-align: center;">95% CI</th>
<th style="text-align: center;">t(147)</th>
<th style="text-align: center;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: center;">6.63</td>
<td style="text-align: center;">0.09</td>
<td style="text-align: center;">(6.45, 6.81)</td>
<td style="text-align: center;">71.67</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">assisted break</td>
<td style="text-align: center;">-0.07</td>
<td style="text-align: center;">0.03</td>
<td style="text-align: center;">(-0.13, -8.61e-03)</td>
<td style="text-align: center;">-2.23</td>
<td style="text-align: center;">0.025</td>
</tr>
<tr class="odd">
<td style="text-align: left;">climbing exp</td>
<td style="text-align: center;">-0.11</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;">(-0.13, -0.09)</td>
<td style="text-align: center;">-10.59</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">distracted</td>
<td style="text-align: center;">0.13</td>
<td style="text-align: center;">0.03</td>
<td style="text-align: center;">(0.07, 0.19)</td>
<td style="text-align: center;">4.29</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fall m</td>
<td style="text-align: center;">0.15</td>
<td style="text-align: center;">0.04</td>
<td style="text-align: center;">(0.08, 0.22)</td>
<td style="text-align: center;">3.97</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>These estimates are a little more tricky to interpret than we’re used to, but nothing we can’t handle. Remember how we used the link function which applied the logarithmic transformation to the expected values? Now need to reckon with this fact.</p>
<p>The parameter estimates as we see above are on the log scale. For example for assisted break, the model predicts -0.07 change in the <em>log</em> of the outcome with the change of one unit of the predictor. The estimate is negative, so we know that as the predictor increases, the log of the outcome decreases (whereas the opposite is true for distraction and fall height). But the values themselves are not particularly illuminating. Luckily, we can transform the betas in a way that will allow us to interpret them in the original units by exponentiating them. This is because exponentiation is the inverse function to the log.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>belay_gamma_exp <span class="ot">&lt;-</span> belay_gamma <span class="sc">|&gt;</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parameters</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>) </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>belay_gamma_exp <span class="sc">|&gt;</span>  </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">display</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 23%">
<col style="width: 12%">
<col style="width: 23%">
<col style="width: 10%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: center;">Prevalence Ratio</th>
<th style="text-align: center;">SE</th>
<th style="text-align: center;">95% CI</th>
<th style="text-align: center;">t(147)</th>
<th style="text-align: center;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: center;">753.74</td>
<td style="text-align: center;">69.67</td>
<td style="text-align: center;">(630.16, 902.53)</td>
<td style="text-align: center;">71.67</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">assisted break</td>
<td style="text-align: center;">0.93</td>
<td style="text-align: center;">0.03</td>
<td style="text-align: center;">(0.88, 0.99)</td>
<td style="text-align: center;">-2.23</td>
<td style="text-align: center;">0.025</td>
</tr>
<tr class="odd">
<td style="text-align: left;">climbing exp</td>
<td style="text-align: center;">0.89</td>
<td style="text-align: center;">9.41e-03</td>
<td style="text-align: center;">(0.88, 0.91)</td>
<td style="text-align: center;">-10.59</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">distracted</td>
<td style="text-align: center;">1.14</td>
<td style="text-align: center;">0.03</td>
<td style="text-align: center;">(1.07, 1.21)</td>
<td style="text-align: center;">4.29</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fall m</td>
<td style="text-align: center;">1.16</td>
<td style="text-align: center;">0.04</td>
<td style="text-align: center;">(1.08, 1.25)</td>
<td style="text-align: center;">3.97</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Now the predictors that are negatively associated with the outcome have values smaller than 1, while predictors with positive association have values greater than 1. As we’ve seen in <a href="#fig-gamma-h1" class="quarto-xref">Figure&nbsp;<span>1.1</span></a>, the relationship between the predictor and the outcome is not entirely linear so the interpretation of the parameters is not as simple as a change in one unit of the predictor associated with the change in the outcome. Instead, what we have is called the Prevalence Ratio. To make the interpretation of PR easier, we’re going to convert PR into percentage change associated with a change in one unit of the predictor. We do this by subtracting 1 from the estimate and then multiplying it by 100. We’ll do this for both the estimate and the confidence intervals:</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-14"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-14-1"><a href="#annotated-cell-14-1" aria-hidden="true" tabindex="-1"></a>belay_gamma_exp <span class="sc">|&gt;</span> </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-14" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-14-2" class="code-annotation-target"><a href="#annotated-cell-14-2" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-14" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-14-3" class="code-annotation-target"><a href="#annotated-cell-14-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-14" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-14-4" class="code-annotation-target"><a href="#annotated-cell-14-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">perc_change =</span> (Coefficient<span class="dv">-1</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-14" data-target-annotation="4" onclick="event.preventDefault();">4</a><span id="annotated-cell-14-5" class="code-annotation-target"><a href="#annotated-cell-14-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">perc_ci_lower =</span> (CI_low<span class="dv">-1</span>) <span class="sc">*</span> <span class="dv">100</span>,</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-14" data-target-annotation="5" onclick="event.preventDefault();">5</a><span id="annotated-cell-14-6" class="code-annotation-target"><a href="#annotated-cell-14-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">perc_ci_upper =</span> (CI_high<span class="dv">-1</span>) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="annotated-cell-14-7"><a href="#annotated-cell-14-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-14" data-target-annotation="6" onclick="event.preventDefault();">6</a><span id="annotated-cell-14-8" class="code-annotation-target"><a href="#annotated-cell-14-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(CI, df_error)) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-14-9"><a href="#annotated-cell-14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">display</span>() </span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-14" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-14" data-code-lines="2" data-code-annotation="1">Take the exponentiated parameter estimates and pipe them convert them into a tibble so we can make some calculations</span>
</dd>
<dt data-target-cell="annotated-cell-14" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-14" data-code-lines="3" data-code-annotation="2">Pipe the tibble into the <code>mutate</code> function.</span>
</dd>
<dt data-target-cell="annotated-cell-14" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-14" data-code-lines="4" data-code-annotation="3">Calculate percentage change <code>perc_change</code> by subtracting each parameter estimate in the Coefficient column from 1 and then multiplying the result by 100.</span>
</dd>
<dt data-target-cell="annotated-cell-14" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-14" data-code-lines="5" data-code-annotation="4">Perform the same calculation for lower confidence interval.</span>
</dd>
<dt data-target-cell="annotated-cell-14" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-14" data-code-lines="6" data-code-annotation="5">perform the same calculation for upper confidence interval.</span>
</dd>
<dt data-target-cell="annotated-cell-14" data-target-annotation="6">6</dt>
<dd>
<span data-code-cell="annotated-cell-14" data-code-lines="8" data-code-annotation="6">Remove unnecessary columns (optional).</span>
</dd>
</dl>
</div>
<div id="tbl-gamma-results" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl quarto-uncaptioned" id="tbl-gamma-results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1.2
</figcaption>
<div aria-describedby="tbl-gamma-results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 14%">
<col style="width: 11%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 13%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: right;">Coefficient</th>
<th style="text-align: right;">SE</th>
<th style="text-align: left;">CI_low</th>
<th style="text-align: right;">CI_high</th>
<th style="text-align: right;">t</th>
<th style="text-align: right;">p</th>
<th style="text-align: right;">perc_change</th>
<th style="text-align: right;">perc_ci_lower</th>
<th style="text-align: right;">perc_ci_upper</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">753.74</td>
<td style="text-align: right;">69.67</td>
<td style="text-align: left;">630.16</td>
<td style="text-align: right;">902.53</td>
<td style="text-align: right;">71.67</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">75274.48</td>
<td style="text-align: right;">62916.45</td>
<td style="text-align: right;">90152.53</td>
</tr>
<tr class="even">
<td style="text-align: left;">assisted_break</td>
<td style="text-align: right;">0.93</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: left;">0.88</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">-2.23</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">-6.68</td>
<td style="text-align: right;">-12.16</td>
<td style="text-align: right;">-0.86</td>
</tr>
<tr class="odd">
<td style="text-align: left;">climbing_exp</td>
<td style="text-align: right;">0.89</td>
<td style="text-align: right;">9.41e-03</td>
<td style="text-align: left;">0.88</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">-10.59</td>
<td style="text-align: right;">3.30e-26</td>
<td style="text-align: right;">-10.54</td>
<td style="text-align: right;">-12.35</td>
<td style="text-align: right;">-8.70</td>
</tr>
<tr class="even">
<td style="text-align: left;">distracted</td>
<td style="text-align: right;">1.14</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: left;">1.07</td>
<td style="text-align: right;">1.21</td>
<td style="text-align: right;">4.29</td>
<td style="text-align: right;">1.76e-05</td>
<td style="text-align: right;">14.05</td>
<td style="text-align: right;">7.41</td>
<td style="text-align: right;">21.11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fall_m</td>
<td style="text-align: right;">1.16</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: left;">1.08</td>
<td style="text-align: right;">1.25</td>
<td style="text-align: right;">3.97</td>
<td style="text-align: right;">7.30e-05</td>
<td style="text-align: right;">16.18</td>
<td style="text-align: right;">7.97</td>
<td style="text-align: right;">25.04</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Let’s take this row by row. The intercept is interpreted as usual - it’s the value of the outcome when all the predictors are 0. For this row, we ignore the <code>perc_change</code> columns we’ve just created.</p>
<p><strong>Assisted breaking device:</strong> We read the <code>perc_change</code> column here. For this predictor, participants who used an assisted breaking device had reaction time lower by -6.68% compared to those who used a regular belay device. Let’s give this a little more context and look at the predictions. Once again, we’re creating a helper prediction tibble with the values for which we want to make predictions. We’re holding all the values constant, apart from <code>assisted_break</code> where we want predicted reaction time for the participants who didn’t use a breaking device (0) as well as those who did (1). If you’re wondering where the other values came from, revisit section <a href="01_gzlms.html#making-predictions">Making predictions</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>prediction_assisted_break <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">climbing_exp =</span> <span class="fl">6.14</span>,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">assisted_break =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">distracted =</span> <span class="dv">0</span>,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">fall_m =</span> <span class="fl">1.82</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We then use the <code>predict</code> function to make a prediction from our model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-16"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><a class="code-annotation-anchor" data-target-cell="annotated-cell-16" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-16-1" class="code-annotation-target"><a href="#annotated-cell-16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(belay_gamma, <span class="at">newdata =</span> prediction_assisted_break) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-16" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-16-2" class="code-annotation-target"><a href="#annotated-cell-16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exp</span>()</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-16" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-16" data-code-lines="1" data-code-annotation="1">Generate prediction</span>
</dd>
<dt data-target-cell="annotated-cell-16" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-16" data-code-lines="2" data-code-annotation="2">Exponentiate from the log scale</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>       1        2 
499.8019 466.4167 </code></pre>
</div>
</div>
<p>The first value is the prediction of the reaction time for those without an assisted breaking device (499.8019 ms) the second value predicts the RT for those <em>with</em> an assisted breaking device (466.4167 ms). As expected, the latter time is shorter. Based on our model, the predicted difference 6.68%. What’s 6.68% of 499.8019?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fl">499.8019</span> <span class="sc">/</span> <span class="dv">100</span> <span class="sc">*</span> <span class="fl">6.68</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 33.38677</code></pre>
</div>
</div>
<p>Now if we subtract this difference from the predicted value…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fl">499.8019</span> <span class="sc">-</span> <span class="fl">33.38677</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 466.4151</code></pre>
</div>
</div>
<p>… we get a predicted value for the second group (ignoring some rounding error on 3rd+ decimal place). This is why we sometimes call this type of parameter estimate a relative change: because we calculate the percentage change relative to a given value.</p>
<p><strong>Climbing experience:</strong> This is a continuous predictor but if you understood the principle of the previous section, this one is not much different. For each year of climbing experience, the model predicts a -10.54% decrease in reaction time. Based on the confidence intervals, this change could be as large as -12.35% or as small as -8.7%.</p>
<p>There’s one final thing we need to highlight about the Gamma models. Revisit <a href="#fig-gamma-h1" class="quarto-xref">Figure&nbsp;<span>1.1</span></a> . Recall that the linear prediction goes into infinity, including unrealistic predictions like negative reaction times. However, the “slope” of the Gamma line seems to be less steep the more we move to the right on climbing experience. This is were relative change really shines.</p>
<p>Say we want to predict the reaction time for someone with two years of climbing experience:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">object =</span> belay_gamma, </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">climbing_exp =</span> <span class="dv">2</span>,</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">assisted_break =</span> <span class="dv">0</span>,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">distracted =</span> <span class="dv">0</span>,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">fall_m =</span> <span class="fl">1.82</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> <span class="fu">exp</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>code        1 
code 792.5492</code></pre>
</div>
</div>
<p>We’ve put the prediction tibble directly into the function to speed things up a bit. While other predictors are held constant, the model predicts a reaction time of 792.5492 for someone who’s been climbing for 2 years. The estimated change for this predictor was 10.54%, which is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fl">792.5492</span> <span class="sc">/</span> <span class="dv">100</span> <span class="sc">*</span> <span class="fl">10.54</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 83.53469</code></pre>
</div>
</div>
<p>So now we can calculate:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fl">792.5492</span> <span class="sc">-</span> <span class="fl">83.53469</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 709.0145</code></pre>
</div>
</div>
<p>and 876.0839 is the reaction time predicted for someone with <em>three</em> years of experience.</p>
<p>What if we took someone at the upper end of climbing experience, say 8 years?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">object =</span> belay_gamma, </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">climbing_exp =</span> <span class="dv">8</span>,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">assisted_break =</span> <span class="dv">0</span>,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">distracted =</span> <span class="dv">0</span>,</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">fall_m =</span> <span class="fl">1.82</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> <span class="fu">exp</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>code        1 
code 406.2939</code></pre>
</div>
</div>
<p>The predicted reaction time is 406.2939, and 10.54% of this value is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fl">406.2939</span> <span class="sc">/</span> <span class="dv">100</span> <span class="sc">*</span> <span class="fl">10.54</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 42.82338</code></pre>
</div>
</div>
<p>42.82. So the value that we’re subtracting becomes lower and lower the further up we move on climbing experience. This effectively prevents us from falling into absurd predictions. Eventually, the prediction line would plateau and be almost completely flat, which makes sense - there’s a physical limit of how fast someone can react.</p>
</section>
<section id="sec-report-gamma" class="level3">
<h3 class="anchored" data-anchor-id="sec-report-gamma">Report</h3>
<p>When reporting any model, we want to strike a balance between reporting all the necessary bits of information and interpreting the parameter estimates in a way that allows us to make conclusions about the hypothesis. Here’s an example of how you could approach but don’t feel beholden to this:</p>
<blockquote class="blockquote">
<p>We fitted a Gamma Generalised Linear Model with the log link function predicting belayers reaction time assisted device use and climbing experience. The covariates in the model were the belayers’ climbing experience and whether they were distracted when belaying their climbing partner.</p>
<p>Based on the posterior predictive checks and residual diagnostics, the model appeared to be well specified. Overall, the model was a good fit, <em>F</em>(4,147) = 40.97, <em>p</em> &lt; .001, and explained 53.53% of deviance in the outcome, <em>R<sup>2</sup></em> = 0.54 (Nagelkerke’s R<sup>2</sup>).</p>
<p>In line with Hypothesis 1, assisted breaking device was a statistically significant predictor of the time it took belayers to stop their climbers’ fall, <em>b</em> = 0.93, 95% CI [0.88, 0.99], <em>SE</em> = 0.03, <em>t</em> = -2.23, <em>p</em> = 0.025, while other predictors were held constant. Belayers who used an assisted breaking device were -6.68% quicker to stop the fall compared to those who didn’t. 95% confidence intervals indicated this difference could be as large as -12.16 or as small as -0.86. This effect was small translated into a difference of 33.38 ms.</p>
<p>Hypothesis 2 was also supported by a statistically significant effect of climbing experience, <em>b</em> = 0.89, 95% CI [0.88, 0.91], <em>SE</em> = 0.01, <em>t</em> = -10.59, <em>p</em> &lt; .001, while holding other predictors constant. A year of climbing experience was associated with a decrease of -10.54%, 95% CI [-12.35%, -8.7%] in belayers’ reaction time. This effect was especially large for belayers with less climbing experience - for example, the model predicted that a belayer with one year of climbing experience would take 885.91 ms to stop a fall while a belayer with two years of experience would take 792.54 ms - a difference of 93.36 ms, which can make a practical difference to the safety of the climber, especially when falling from a lower height where the likelihood of injury is increased.</p>
<p>The effects of both covariates (distraction and fall height) - were also statistically significant - full results are reported in <a href="#tbl-gamma-results" class="quarto-xref">Table&nbsp;<span>1.2</span></a>.</p>
</blockquote>
</section>
</section>
<section id="exercises" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="exercises"><span class="header-section-number">1.2</span> Exercises</h2>
<section id="what-does-this-code-do" class="level3">
<h3 class="anchored" data-anchor-id="what-does-this-code-do">What does this code do?</h3>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Here’s all the code we have written in this section. Can you remember what each line of each codechunk does? Are there any codechunks that you struggle to make sense of? Make sure to revisit the section in which it is used and take notes.</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(easystats)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>belay_tib <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/climbing_data.csv"</span>) <span class="sc">|&gt;</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  readr<span class="sc">::</span><span class="fu">read_csv</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>gamma_dist <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="at">n =</span> <span class="dv">10000</span>, <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">scale =</span> <span class="dv">2</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="cn">NULL</span>, <span class="fu">aes</span>(<span class="at">x =</span> gamma_dist)) <span class="sc">+</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>... <span class="sc">+</span> </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"glm"</span>, <span class="at">colour =</span> <span class="st">"darkorange"</span>, <span class="at">fill =</span> <span class="st">"darkorange"</span>, </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> <span class="st">"Gamma"</span>)) <span class="sc">+</span> </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>...</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>belay_tib <span class="sc">|&gt;</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">data =</span> _, <span class="fu">aes</span>(<span class="at">x =</span> climbing_exp, <span class="at">y =</span> reaction_time)) <span class="sc">+</span> </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">colour =</span> <span class="st">"yellowgreen"</span>) <span class="sc">+</span> </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">colour =</span> <span class="st">"steelblue"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span> </span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"glm"</span>, </span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">"darkorange"</span>, <span class="at">fill =</span> <span class="st">"darkorange"</span>, </span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> <span class="st">"Gamma"</span>)) <span class="sc">+</span> </span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1030.5</span>)) <span class="sc">+</span> </span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Belayer's climbing experience (in years)"</span>, <span class="at">y =</span> <span class="st">"Reaction time (ms) to break the fall"</span>) <span class="sc">+</span> </span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>belay_gamma <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  reaction_time <span class="sc">~</span> assisted_break <span class="sc">+</span> climbing_exp <span class="sc">+</span> distracted <span class="sc">+</span> fall_m,</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>), </span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> belay_tib </span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>belay_gamma <span class="sc">|&gt;</span> <span class="fu">check_model</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tbl-cap="">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>belay_gamma <span class="sc">|&gt;</span> </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">performance</span>() <span class="sc">|&gt;</span> </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">display</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>belay_gamma <span class="sc">|&gt;</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">test_wald</span>() <span class="sc">|&gt;</span> </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">display</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>belay_gamma <span class="sc">|&gt;</span> </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parameters</span>() <span class="sc">|&gt;</span> </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">display</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>belay_gamma_exp <span class="ot">&lt;-</span> belay_gamma <span class="sc">|&gt;</span> </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">parameters</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>) </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>belay_gamma_exp <span class="sc">|&gt;</span>  </span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">display</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tbl-cap="">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>belay_gamma_exp <span class="sc">|&gt;</span> </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>( </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">perc_change =</span> (Coefficient<span class="dv">-1</span>) <span class="sc">*</span> <span class="dv">100</span>, </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">perc_ci_lower =</span> (CI_low<span class="dv">-1</span>) <span class="sc">*</span> <span class="dv">100</span>, </span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">perc_ci_upper =</span> (CI_high<span class="dv">-1</span>) <span class="sc">*</span> <span class="dv">100</span> </span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(CI, df_error)) <span class="sc">|&gt;</span> </span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">display</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">object =</span> belay_gamma, </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">climbing_exp =</span> <span class="dv">2</span>,</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">assisted_break =</span> <span class="dv">0</span>,</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">distracted =</span> <span class="dv">0</span>,</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">fall_m =</span> <span class="fl">1.82</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> <span class="fu">exp</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">object =</span> belay_gamma, </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">climbing_exp =</span> <span class="dv">8</span>,</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">assisted_break =</span> <span class="dv">0</span>,</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">distracted =</span> <span class="dv">0</span>,</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">fall_m =</span> <span class="fl">1.82</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> <span class="fu">exp</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="worksheet" class="level3">
<h3 class="anchored" data-anchor-id="worksheet">Worksheet</h3>
<p><strong>Scenario:</strong></p>
<blockquote class="blockquote">
<p>The International Civil Aviation Organisation is reviewing the efficiency of the alerts for the Ground Proximity Warning System (GPWS), which warns pilots when the aircraft is too close to the ground or other terrain (like mountains). Currently, the GPWS alerts the pilots by an auditory signal. The aviation authority is deciding whether to replace the auditory signal with a visual one. Because light moves as at a faster speed than sound, they hypothesise that:</p>
<p><strong>H<sub>1</sub>: Pilots will be able to respond significantly faster to visual stimuli, compared to auditory stimuli.</strong></p>
<p>They hired you as a cognitive scientist to carry out an experiment and recommend a policy change if appropriate. During the experiment, novice pilots without experience of the existing GPWS were placed in a flight simulator and presented with a warning at a random point during the flight. This warning is either auditory or visual (<code>modality</code>, auditory coded as 0, visual coded as 1) and it is displayed either as a simple signal (a short alarm for the auditory modality or a light indicator for the visual modality), or as a brief message with the instruction “Terrain, pull up!” - either spoken or displayed on a flight monitor (<code>signal_complexity</code>, simple alert coded as 0, message coded as 1). You also measured the pilots’ subjective perception of their own alertness (<code>alertness</code>) ranging from 0 (not alert) to 10 (very alert) and the time from the beginning of the flight to the point when GPWS was triggered in minutes (<code>gpws_time</code>). All of these variables should be included as the predictors in the model. The outcome was measured as the time it took the pilots to respond to the warning with a corrective action in milliseconds (<code>response_time</code>).</p>
</blockquote>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Use the tutorial to complete the following tasks:</strong></p>
<ol type="1">
<li>Generate descriptive statistics and an informative data visualisation for the hypothesis</li>
<li>Fit two models
<ul>
<li>Model 1: Assuming a normal conditional distribution for the outcome. Call the model <code>alert_glm</code> .</li>
<li>Model 2: Assuming a gamma conditional distribution for the outcome. Call the model <code>alert_gamma</code> .</li>
</ul></li>
<li>Evaluate the model assumptions and the overall fit for both models. Decide which modelling approach is more appropriate.</li>
<li>Generate the parameter estimates for the model you selected in the previous step.</li>
<li>Write up a short report (up to 300 words), including:
<ul>
<li>A summary of your evaluation in Task 3</li>
<li>Overall fit statistics</li>
<li>Interpretation of the parameter estimates</li>
<li>Policy recommendation based on the results</li>
</ul></li>
</ol>
</div>
</div>
</div>
<p>You can use the “worksheet” file in the quarto folder to prepare the worksheet. The data are stored in the file <a href="data/alert_data.csv">alert_data.csv</a>. Download the data and <a href="index.html#importing-datasets">import it to Posit Cloud</a>. Once you’ve done so, you can read the data into R by running:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>alert_tib <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/alert_data.csv"</span>) <span class="sc">|&gt;</span> readr<span class="sc">::</span><span class="fu">read_csv</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Remember to load the necessary packages.</p>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Optional extra task:</strong></p>
<p>Use <code>alert_glm</code> and <code>alert_gamma</code> to make two separate response time predictions for a pilot who was presented with a visual alert in form of a short message, and who’s subjective alertness and flight duration before the alert were at the average levels found in the sample.</p>
</div>
</div>
</div>
</section>
<section id="check-worksheet-values" class="level3">
<h3 class="anchored" data-anchor-id="check-worksheet-values">Check worksheet values</h3>
<p>Once you’ve finished the worksheet, you can ask me to look through your work and give you feedback. Remember that you should also practice writing up the results in a brief report, not just running the code. If you’re stuck, you can use the quiz below to guide you.</p>
<p>You can also use the quiz below - if you fitted the models the correctly, your answers should match the values below.</p>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Worksheet check
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>How alert were the pilots in the study on average? 5.14</p>
<p>What was the average time from the start of the flight to the point of the alert? 45.753</p>
<p>The Gaussian model predicts an increase of 175.57 milliseconds in response time for the visual modality compared to the auditory modality.</p>
<p>Which two assumptions of OLS estimation are the most obviously violated for Gaussian model?</p>
<div id="radio_ZWVTFTLFOA" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_ZWVTFTLFOA" value=""> <span>Linearity and influential cases</span></label><label><input type="radio" autocomplete="off" name="radio_ZWVTFTLFOA" value=""> <span>Linearity and heteroscedasticity</span></label><label><input type="radio" autocomplete="off" name="radio_ZWVTFTLFOA" value=""> <span>Normal errors and influential cases</span></label><label><input type="radio" autocomplete="off" name="radio_ZWVTFTLFOA" value=""> <span>Heteroscedasticity and collinearity</span></label><label><input type="radio" autocomplete="off" name="radio_ZWVTFTLFOA" value="answer"> <span>Heteroscedasticity and normal errors</span></label><label><input type="radio" autocomplete="off" name="radio_ZWVTFTLFOA" value=""> <span>Collinearity and influential cases</span></label><label><input type="radio" autocomplete="off" name="radio_ZWVTFTLFOA" value=""> <span>Collinearity and normal errors</span></label>
</div>
<p>Based on the posterior predictive check, which model is a better fit?</p>
<div id="radio_WVXGAVDLIQ" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_WVXGAVDLIQ" value="answer"> <span>Gamma model</span></label><label><input type="radio" autocomplete="off" name="radio_WVXGAVDLIQ" value=""> <span>Gausian model</span></label>
</div>
<p>The Gamma model explained 28.6 percent of total deviance in the outcome. Compared to the Gaussian model, this proportion was greater by 3.1 percent.</p>
<p>Overall, the Gamma model was a good fit, <em>F</em>(4,86) = 8.41, <em>p</em> &lt; .001.</p>
<p>The time it took the pilots to respond to visual stimuli was 10.1 percent greater compared to response times to auditory signals. Based on this the proposed change from auditory signals to visual signals…</p>
<div id="radio_ILWCOWEQLP" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_ILWCOWEQLP" value=""> <span>… should be implemented.</span></label><label><input type="radio" autocomplete="off" name="radio_ILWCOWEQLP" value="answer"> <span>… should NOT be implemented</span></label>
</div>
<p><strong>Optional task:</strong></p>
<p>For a pilot presented with a visual alert who’s subjective alertness and flight duration before the alert were at average levels, the Gaussian models predict the response time of 1659.69 milliseconds, while the Gamma model predicts a response time of 1647.06 milliseconds.</p>
</div>
</div>
</div>


</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>You could substitute the term “expected” with “predicted”. The only difference is that we tend to use “predicted” when talking about a single value, and “expected” when talking about a whole distribution, but for all intents and purposes, they are the same.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;
    
    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");
  
  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");
  
  var cl = this.classList
  
  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;
  
  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }
  
  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

window.onload = function() {
  console.log("onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }
  
  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }
  
  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
  }

  update_total_correct();
}

</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./01_gzlms.html" class="pagination-link" aria-label="Generalised Linear Models">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Generalised Linear Models</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./01b_gzlms_counts.html" class="pagination-link" aria-label="Modelling counts">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Modelling counts</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>2&nbsp; Modelling counts – Advanced Statistics 25/26</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./01c_gzlms_ordinal.html" rel="next">
<link href="./01a_gzlms_skewed.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="site_libs/datatables-binding-0.33/datatables.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="assets/webex.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01_gzlms.html">Generalised Linear Models</a></li><li class="breadcrumb-item"><a href="./01b_gzlms_counts.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Modelling counts</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Advanced Statistics 25/26</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome to Advanced Statistics</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./01_gzlms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Generalised Linear Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01a_gzlms_skewed.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Modelling skewness</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01b_gzlms_counts.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Modelling counts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01c_gzlms_ordinal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Modelling ordinal outcomes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01d_gzlms_summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Summary</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./02_ma.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Meta-analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02a_ma_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Introduction to meta-analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02b_ma_advanced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Advanced meta-analytic methods</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02c_ma_assessment_support.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Assessment support</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./03_measurement.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Measurement</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03a_measurement_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">EFA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03b_measurement_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">CFA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03c_measurement_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Measurement invariance</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_cex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Computer Exam</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_open_topic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Open Topic</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="4">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#scenario" id="toc-scenario" class="nav-link active" data-scroll-target="#scenario">Scenario</a>
  <ul>
  <li><a href="#packages" id="toc-packages" class="nav-link" data-scroll-target="#packages">Packages</a></li>
  <li><a href="#the-data" id="toc-the-data" class="nav-link" data-scroll-target="#the-data">The data</a></li>
  <li><a href="#descriptives-and-data-viz" id="toc-descriptives-and-data-viz" class="nav-link" data-scroll-target="#descriptives-and-data-viz">Descriptives and data viz</a></li>
  </ul></li>
  <li><a href="#poisson-models" id="toc-poisson-models" class="nav-link" data-scroll-target="#poisson-models"><span class="header-section-number">2.1</span> Poisson models</a>
  <ul>
  <li><a href="#fit-the-model" id="toc-fit-the-model" class="nav-link" data-scroll-target="#fit-the-model">Fit the model</a></li>
  <li><a href="#evaluate-the-model-fit" id="toc-evaluate-the-model-fit" class="nav-link" data-scroll-target="#evaluate-the-model-fit">Evaluate the model fit</a></li>
  <li><a href="#over-dispersion" id="toc-over-dispersion" class="nav-link" data-scroll-target="#over-dispersion">Over-dispersion</a></li>
  </ul></li>
  <li><a href="#negative-binomial-models" id="toc-negative-binomial-models" class="nav-link" data-scroll-target="#negative-binomial-models"><span class="header-section-number">2.2</span> Negative binomial models</a>
  <ul>
  <li><a href="#fit-the-model-1" id="toc-fit-the-model-1" class="nav-link" data-scroll-target="#fit-the-model-1">Fit the model</a></li>
  <li><a href="#evaluate-the-model-fit-1" id="toc-evaluate-the-model-fit-1" class="nav-link" data-scroll-target="#evaluate-the-model-fit-1">Evaluate the model fit</a></li>
  </ul></li>
  <li><a href="#quasi-poisson-models" id="toc-quasi-poisson-models" class="nav-link" data-scroll-target="#quasi-poisson-models"><span class="header-section-number">2.3</span> Quasi-Poisson models</a>
  <ul>
  <li><a href="#fit-the-model-2" id="toc-fit-the-model-2" class="nav-link" data-scroll-target="#fit-the-model-2">Fit the model</a></li>
  <li><a href="#evaluate-the-model-fit-2" id="toc-evaluate-the-model-fit-2" class="nav-link" data-scroll-target="#evaluate-the-model-fit-2">Evaluate the model fit</a></li>
  <li><a href="#extract-model-parameters" id="toc-extract-model-parameters" class="nav-link" data-scroll-target="#extract-model-parameters">Extract model parameters</a></li>
  <li><a href="#interpretation" id="toc-interpretation" class="nav-link" data-scroll-target="#interpretation">Interpretation</a></li>
  </ul></li>
  <li><a href="#zero-inflated-models-a-gentle-introduction" id="toc-zero-inflated-models-a-gentle-introduction" class="nav-link" data-scroll-target="#zero-inflated-models-a-gentle-introduction"><span class="header-section-number">2.4</span> Zero-inflated models (a gentle introduction)</a>
  <ul>
  <li><a href="#deciding-between-models" id="toc-deciding-between-models" class="nav-link" data-scroll-target="#deciding-between-models">Deciding between models</a></li>
  <li><a href="#report" id="toc-report" class="nav-link" data-scroll-target="#report">Report</a></li>
  </ul></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">2.5</span> Exercises</a>
  <ul>
  <li><a href="#what-does-this-code-do" id="toc-what-does-this-code-do" class="nav-link" data-scroll-target="#what-does-this-code-do">What does this code do?</a></li>
  <li><a href="#worksheet" id="toc-worksheet" class="nav-link" data-scroll-target="#worksheet">Worksheet</a>
  <ul class="collapse">
  <li><a href="#poisson-model-output" id="toc-poisson-model-output" class="nav-link" data-scroll-target="#poisson-model-output"><strong>Poisson model output:</strong></a></li>
  <li><a href="#gamma-model-output" id="toc-gamma-model-output" class="nav-link" data-scroll-target="#gamma-model-output"><strong>Gamma model output:</strong></a></li>
  </ul></li>
  <li><a href="#check-worksheet-values" id="toc-check-worksheet-values" class="nav-link" data-scroll-target="#check-worksheet-values">Check worksheet values</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01_gzlms.html">Generalised Linear Models</a></li><li class="breadcrumb-item"><a href="./01b_gzlms_counts.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Modelling counts</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Modelling counts</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In the previous section, we looked at the consequences of pretending a bound asymmetrically distribution is unbound and symmetrical. In this tutorial, we’re going to discuss what happens if we assume that a distribution is continuous when, in fact, it is not.</p>
<p>Every model that we fit makes one fundamental assumption that more often than not won’t be highlighted on any diagnostic plots. It’s the assumption about the level of measurement of our variable. For example, logistic models assume that the outcome variable is a <strong>categorical binary</strong> variable, ordinal models assume the outcome is <strong>ordinal</strong>, Gaussian and Gamma models assume that it is <strong>continuous</strong>. The reason why software often doesn’t provide an immediately obvious way to check that this assumption is met is that it is out responsibility as the researcher to ensure the way we’re operationalising a variable is suitable for the kind of model we want to fit later.</p>
<p>Another level of measurement is <strong>counts</strong>. For example:</p>
<ul>
<li><p>How many cups of coffee does an average lecturer drink per day?</p></li>
<li><p>How many children are there in a typical household?</p></li>
<li><p>How many goals are typical in a football game?</p></li>
<li><p>How many short-form videos does an average grad student scroll through per day when procrastinating from their dissertation work/thesis?</p></li>
</ul>
<p>Counts are characterised as integers - this means that they can only be expressed as a whole number without decimal points. Despite this, they are another victim of the GLM tyranny, more often than not modelled as unbound continuous variables. The consequences of assuming a continuous level of measurement when the variable is measured in counts vary in severity, depending on the context. For example, if we say that an average lecturer drinks 3.5 cups of coffee per day, it implies that they either make half a cup of coffee (which is silly), or they make four and then pour out half of one (which is unhinged). However, if we say that a typical household consists of two parents, one dog, one cat, and 2.4 children, things suddenly take a dark turn.</p>
<p>In this tutorial, we’re going to look into ways of modelling count variables more sensibly. We’ll explore the following types of models:</p>
<ul>
<li><p>Poisson models</p></li>
<li><p>Negative binomial models</p></li>
<li><p>Quasi-poisson models</p></li>
<li><p>Zero-inflated models</p></li>
</ul>
<section id="scenario" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="scenario">Scenario</h2>
<blockquote class="blockquote">
<p>A university lecturer wishes to understand the predictors of undergraduate student attendance in lectures. They record the number of lectures the students attended (<code>n_lectures</code>) per 11-week term (with one lecture per week). For predictors, they considers:</p>
<ul>
<li><p>Year of study - first, second, or third (<code>year</code>)</p></li>
<li><p>How many lecture recordings they accessed (<code>n_record</code>)</p></li>
<li><p>Average grade on the module (<code>overall_grade</code>)</p></li>
</ul>
<p>The lecturer wants to include all the predictors in the model. They make a hypothesis regarding the year of study:</p>
<p>H<sub>1</sub>: First year students will be more likely to attend lectures compared to second and third year students.</p>
</blockquote>
<section id="packages" class="level3">
<h3 class="anchored" data-anchor-id="packages">Packages</h3>
<p>We’re using the following packages:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(easystats)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS) <span class="co"># for fitting negative binomial models </span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pscl) <span class="co"># for fitting zero-inflated models </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="the-data" class="level3">
<h3 class="anchored" data-anchor-id="the-data">The data</h3>
<p>The data are stored in the <a href="data/attendance_data.csv">attendance_data.csv</a>. Download the data and <a href="index.html#importing-datasets">import it to Posit Cloud</a>. Once you’ve done so, you can read the data into R by running:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>attend_tib <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/attendance_data.csv"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  readr<span class="sc">::</span><span class="fu">read_csv</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Before we do anything else, we should always check our data to make sure the reading command worked as intended<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>attend_tib </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-5d5187f3d032612e6ee6" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-5d5187f3d032612e6ee6">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467","468","469","470","471","472","473","474","475","476","477","478","479","480","481","482","483","484","485","486","487","488","489","490","491","492","493","494","495","496","497","498","499","500","501","502","503","504","505","506","507","508","509","510","511","512","513","514","515","516","517","518","519","520","521","522","523","524","525","526","527","528","529","530","531","532","533","534","535","536","537","538","539","540","541","542","543","544","545","546","547","548","549","550","551","552","553","554","555","556","557","558","559","560","561","562","563","564","565","566","567","568","569","570","571","572","573","574","575","576","577","578","579","580","581","582","583","584"],[25654,21208,23909,25992,28035,24606,28198,20309,27449,20696,22735,25360,29842,29116,22186,23788,20979,26465,26743,22052,28472,28368,27913,21307,22631,23637,27929,21512,22200,27875,23380,26439,29941,27145,28454,22033,20978,23699,26209,28025,22985,27529,25598,27650,28762,22469,27198,21971,23776,29905,29482,27944,20478,25159,28924,23827,20312,28535,27546,21627,21597,25041,25468,27642,29193,24747,23100,20864,24567,28356,25989,23723,23188,24228,28823,27104,27570,22210,24534,26385,27609,28550,22755,29467,22980,22261,24717,23927,21220,27896,22460,21618,20200,24666,21718,20734,26649,23544,26757,28559,25997,21483,29401,21539,26082,26532,21442,20527,29622,27863,21401,26820,24506,21529,21453,23899,28104,23373,25121,20582,21559,20128,22744,22336,25451,27217,27501,24498,27185,21862,27455,23439,22455,24247,25376,24803,24826,26571,24370,24211,26756,24587,28390,27424,27849,24147,24566,29367,24804,28848,28023,29334,23361,29485,27312,21160,23337,24148,29973,25173,27624,28007,27981,26904,27137,29518,23037,26227,23962,21516,23854,20336,26067,20941,24501,21631,24219,21538,24757,20994,22565,27785,21604,23319,28760,29335,28588,23353,25490,21092,22358,21075,27910,27537,29714,29132,20928,25369,25432,22341,29802,25166,23350,22022,27313,25304,21575,21839,28194,26485,20026,24950,27758,29186,25455,23343,29261,22473,26195,25361,29793,25991,24395,28324,26125,28098,29474,22050,21175,23050,28108,25318,22796,22087,20768,27732,22888,20669,23202,25515,20694,25196,22401,29619,26801,26296,28668,20891,21988,25373,22792,25878,29870,24134,23287,28247,28080,22256,20489,27175,27560,26677,26012,27703,26158,27578,29301,27048,28879,27364,24133,23431,23997,26673,22103,26267,28041,28949,26972,26151,26274,28574,22029,28393,24595,28005,25018,27100,22244,25719,21747,20503,20137,23070,22529,28646,28064,28385,29551,21928,25988,24139,28887,26973,25499,23040,22657,28936,23834,20154,28730,25772,22733,20759,21976,20172,24025,20456,28063,29830,25011,26248,25085,21526,21975,29164,28943,21168,23244,29664,24034,29801,26092,28001,25993,24448,23710,20884,20243,20158,28577,27783,20208,21732,22292,29069,29633,24919,28028,28700,24504,22711,20858,23422,20554,26911,29901,29117,24951,26107,20444,25504,28915,20560,24987,27768,24716,27379,21124,21494,21303,25401,28867,29224,29612,27618,24535,22600,24368,23999,25153,25399,28921,22409,21146,22537,22424,29867,25459,26956,24157,23681,21056,25026,26362,26142,29806,25042,22028,20482,22091,27113,24152,24744,26463,28314,20379,23113,24331,23587,20471,26620,29057,27613,27959,22728,22981,24635,29389,20049,22042,25271,25207,27075,28101,22672,29138,25773,22365,29544,23390,23359,27264,23150,21523,23588,21482,25581,26957,21418,21214,20521,28739,24225,27087,23211,20510,24688,26885,29248,29203,21064,28746,23362,26075,26530,20794,27056,23655,23443,27021,23349,20443,22153,26593,24392,21355,21753,27181,25302,23177,22671,23528,21760,20414,23979,29966,28884,26199,20222,26034,24814,25321,20411,21284,28377,25596,20065,25343,24003,27173,23534,20894,25912,28009,28529,28781,21691,22778,20569,20491,25056,20494,28446,29970,22188,25642,22622,20615,27156,23138,26347,21395,23593,26827,27652,24918,21009,27895,21389,29685,21735,22417,27819,23314,22081,26203,20195,25356,27617,22549,21566,26131,21737,24166,20319,23497,26157,23155,29520,26952,29881,24009,24581,20429,28547,25422,22378,29548,21095,22497,26117,24882,25538,20782,20917,25617,29044,25650,24689,23868,29845,23609,28132,26234,26392,25661,22628,21434,20741,25102,29796,24008,28326,26565,27247,25646,20667,29029,26410,22155,22972,21794,23682],[3,0,1,1,1,1,0,2,1,2,2,3,2,0,0,0,0,0,0,0,1,0,3,1,2,4,0,1,0,2,0,1,0,5,0,0,2,8,2,0,0,0,1,1,1,2,3,2,1,1,8,0,1,0,0,0,0,1,1,6,1,3,2,1,1,0,1,2,3,1,0,2,1,1,0,0,0,1,0,0,0,0,0,7,0,0,5,1,0,1,0,2,1,1,1,2,3,1,0,3,0,1,5,4,1,3,1,0,6,1,0,5,4,1,0,0,0,4,0,3,0,0,0,0,1,1,1,1,0,1,1,1,1,0,2,5,0,0,0,2,2,1,0,1,3,0,2,0,1,5,3,0,0,1,1,0,0,0,5,1,0,2,3,3,0,2,0,4,1,2,0,0,5,6,1,3,0,1,1,0,1,0,0,0,0,1,6,1,1,1,3,0,1,2,0,3,0,0,1,0,1,2,8,0,2,1,5,4,0,4,1,0,1,1,2,4,2,1,0,1,0,0,2,0,2,0,0,1,2,0,3,0,0,0,3,2,1,0,3,1,3,2,1,1,1,2,3,0,3,2,0,1,0,2,0,0,0,0,0,0,0,1,3,2,1,1,0,1,0,0,0,0,2,1,1,0,4,2,6,0,0,6,1,0,2,4,0,0,3,0,1,3,0,3,4,0,0,5,0,4,1,1,1,0,0,0,3,0,0,0,1,0,4,2,2,3,5,2,0,1,1,0,1,0,3,2,0,0,0,0,1,2,0,0,0,0,3,0,1,0,5,3,1,1,0,3,3,1,0,0,2,2,1,0,0,1,0,2,3,1,1,10,0,0,2,2,1,2,0,1,0,2,0,1,2,0,0,3,0,0,0,1,0,1,2,2,3,0,0,0,5,2,0,3,5,1,0,3,0,1,6,0,5,0,2,0,0,2,2,1,2,0,0,1,0,1,0,0,4,1,2,3,1,2,3,1,3,0,0,1,1,1,0,2,4,0,2,2,1,0,1,1,2,2,3,1,7,1,0,5,2,1,0,0,1,0,0,2,0,1,4,0,0,0,1,1,3,3,2,2,0,3,0,0,1,1,1,1,1,0,1,0,0,1,0,0,1,2,1,0,5,0,0,0,0,0,3,0,1,0,2,0,4,3,0,0,3,0,3,0,0,0,0,1,3,3,1,2,3,0,2,0,0,0,0,0,0,0,1,0,0,0,1,5,3,0,1,7,6,0,0,0,1,0,0,2,0,1,0,0,1,1,3,0,0,0,0,4,2,0,5,0,1,1,5,7,0,1,3,2,5,2,1,1,0,3,1,0,1,5,1,3,0,3],["Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 3","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 3","Year 3","Year 2","Year 2","Year 2","Year 2","Year 2","Year 1","Year 2","Year 2","Year 2","Year 2","Year 2","Year 1","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 1","Year 2","Year 2","Year 2","Year 2","Year 2","Year 3","Year 2","Year 2","Year 3","Year 1","Year 2","Year 2","Year 2","Year 2","Year 2","Year 1","Year 2","Year 1","Year 3","Year 3","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 3","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 1","Year 2","Year 2","Year 2","Year 2","Year 3","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 1","Year 2","Year 2","Year 3","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 1","Year 1","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 3","Year 2","Year 2","Year 1","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 1","Year 2","Year 2","Year 2","Year 3","Year 2","Year 2","Year 2","Year 2","Year 2","Year 3","Year 2","Year 1","Year 3","Year 2","Year 2","Year 1","Year 1","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 1","Year 2","Year 1","Year 2","Year 3","Year 2","Year 1","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 1","Year 2","Year 2","Year 3","Year 3","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 3","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 1","Year 2","Year 2","Year 3","Year 1","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 1","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 3","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 3","Year 2","Year 2","Year 2","Year 1","Year 2","Year 2","Year 2","Year 2","Year 2","Year 3","Year 2","Year 2","Year 3","Year 3","Year 3","Year 2","Year 3","Year 2","Year 2","Year 2","Year 1","Year 2","Year 1","Year 2","Year 2","Year 2","Year 2","Year 2","Year 3","Year 2","Year 2","Year 3","Year 3","Year 2","Year 2","Year 2","Year 2","Year 2","Year 3","Year 2","Year 2","Year 2","Year 2","Year 2","Year 3","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 3","Year 2","Year 2","Year 3","Year 1","Year 1","Year 2","Year 1","Year 2","Year 2","Year 2","Year 2","Year 1","Year 2","Year 3","Year 1","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 1","Year 2","Year 2","Year 1","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 3","Year 2","Year 2","Year 2","Year 3","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 3","Year 2","Year 2","Year 3","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 3","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 3","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 3","Year 2","Year 2","Year 2","Year 2","Year 2","Year 1","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 1","Year 2","Year 2","Year 2","Year 2","Year 1","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 1","Year 2","Year 2","Year 2","Year 3","Year 2","Year 2","Year 2","Year 2","Year 3","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 3","Year 3","Year 2","Year 3","Year 2","Year 2","Year 3","Year 2","Year 2","Year 2","Year 2","Year 3","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 1","Year 1","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 3","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 3","Year 2","Year 1","Year 2","Year 3","Year 2","Year 2","Year 1","Year 3","Year 3","Year 2","Year 1","Year 1","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 1","Year 3","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 3","Year 2","Year 2","Year 2","Year 2","Year 2","Year 3","Year 2","Year 2","Year 3","Year 2","Year 2","Year 2","Year 2","Year 3","Year 2","Year 3","Year 2","Year 2","Year 1","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 3","Year 2","Year 3","Year 3","Year 2","Year 2","Year 3","Year 2","Year 2","Year 3","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 3","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 3","Year 1","Year 2","Year 3","Year 2","Year 2","Year 2","Year 2","Year 2","Year 2","Year 1","Year 2","Year 2"],[5,3,4,4,5,5,6,7,4,8,1,6,6,2,7,6,5,6,6,5,4,5,6,4,6,8,5,7,6,5,5,5,4,7,5,6,3,5,5,6,3,4,11,6,6,5,6,5,5,6,4,5,4,3,5,4,6,4,4,9,6,5,5,5,5,6,4,5,7,5,5,6,9,4,1,7,6,4,9,6,5,7,7,6,7,4,4,5,4,4,6,7,6,4,7,4,4,5,5,4,5,4,7,5,5,5,5,5,4,5,4,3,2,5,7,6,6,5,3,4,7,7,6,7,7,4,6,8,4,6,3,6,5,2,6,5,5,3,4,7,8,8,8,3,3,3,4,4,5,4,5,6,7,4,6,4,3,7,8,4,5,5,6,3,6,6,5,5,5,8,1,5,4,4,6,6,4,5,8,6,8,10,5,7,5,4,7,3,3,8,2,5,2,9,4,4,5,3,5,5,7,6,5,5,8,3,7,4,6,7,3,5,5,6,4,3,3,8,8,7,6,6,5,3,6,8,6,4,8,4,5,6,6,3,5,5,6,7,5,3,6,3,5,7,6,5,4,7,8,8,4,6,5,5,4,7,3,4,8,4,5,5,7,4,6,6,7,4,8,4,6,6,2,4,6,3,4,10,6,5,5,3,3,4,6,6,3,4,7,5,4,5,6,4,4,6,7,5,7,6,3,3,5,5,7,5,7,5,5,5,8,3,6,3,4,7,4,5,5,7,5,3,5,4,5,3,7,3,5,7,7,5,7,2,7,6,3,5,8,6,4,6,4,4,4,7,5,4,5,7,6,5,6,3,7,8,6,3,6,6,3,3,3,5,5,6,7,6,8,6,4,6,6,6,5,5,10,3,5,5,6,5,6,0,6,6,6,5,4,2,4,9,5,7,8,6,5,3,5,5,8,5,6,7,7,5,4,5,5,4,2,5,5,6,4,5,6,6,4,2,4,7,4,6,6,6,4,1,7,6,5,6,8,4,6,5,7,7,3,5,6,5,5,5,4,9,5,7,3,5,5,6,5,7,3,6,8,7,6,6,8,6,4,7,7,6,6,3,6,7,4,7,3,5,6,7,7,4,4,6,3,5,5,5,3,2,8,6,6,7,6,6,4,4,3,5,3,6,2,6,2,3,4,5,5,6,6,4,6,4,2,6,4,6,5,5,7,8,4,2,4,7,8,7,8,4,6,6,4,7,5,3,3,8,6,4,3,5,6,3,8,7,6,4,2,6,5,6,6,6,4,5,6,5,5,5,6,7,5,6,6,7,4,6,7,3,6,3,2,9,6,4,6,9,9,5,5,6,7,3,7,5,4,7],[74.25,54.78,69.69,59.46,55.88,51.81,54.69,25.59,49.27,56.86,68.52,61.56,53.3,53.78,60.97,43.42,82.72,45.84,58.37,55.41,60.82,49.4,51.37,56.63,72.55,65.70999999999999,78.34,48.18,33.44,63.25,56.66,55.95,40.02,65.84999999999999,38.55,35.55,51.11,48.32,65.17,68.05,22.35,44.9,70.27,52.36,49.72,58.3,49.67,42.5,49.96,58.81,43.92,66.37,50.7,35.14,65.55,61.74,66.06999999999999,30.28,36.41,51.37,60.03,96.56999999999999,86.43000000000001,61.04,53.72,53.89,47.21,50.38,59.58,43.35,67.17,58.89,66.31,45.44,67.15000000000001,54.55,46.34,55.06,40.91,66.43000000000001,53.03,39.03,48.05,66.87,54.04,37.96,63.26,50.13,76.33,66.2,72.72,60.68,65.2,57.23,68.79000000000001,59.45,70.88,42.63,61.57,54.16,57.59,47.39,50.43,58.34,36.93,67.65000000000001,66.45999999999999,56.55,63.54,34.62,52.98,62.98,41.5,60.89,40,56.89,35.41,55.68,62.05,58.76,50.79,57.72,66.77,40.2,75.18000000000001,41.25,41.37,24.53,37.39,53.55,53.3,66.05,37.73,53.13,54.59,74.56,57,69.05,52.3,52.4,62.11,67.34999999999999,68.39,55.95,51.64,49.12,56.97,56.02,60.11,61.28,66.68000000000001,63.16,60,69.28,50.01,49.21,44.7,57.33,50.59,44.46,33.19,65.20999999999999,51.54,65.41,63.5,73.11,70.98999999999999,53.95,67.47,57.63,53.75,67.47,80.40000000000001,65.94,76.29000000000001,46.87,46.23,43.83,62.97,48.73,42.61,37.7,67.42,53.21,42.68,67.48999999999999,65.04000000000001,61.72,59.44,46.92,35.93,63.4,57.22,61.8,41.81,53.54,48.16,38.67,69.09999999999999,68.03,56.78,48.35,55.85,50.35,61.03,57.62,93.75,37.15,57.24,42.85,53.95,44.01,56.76,47,54.06,33.5,44.85,50.74,51.11,50.28,67.70999999999999,71.53,55.84,50.52,54.96,58.81,47.37,47.34,58.19,41.84,60.56,49.58,48.69,50.29,53.53,31.74,40.23,50.49,56.11,51.31,40.75,52.68,0,43.63,76.19,22.81,59.38,23.5,68.26000000000001,66.23,49.4,51.15,50.13,47.14,43.49,46.59,61.2,43.81,72.68000000000001,30.11,83.20999999999999,69.88,66.84999999999999,51.02,62.61,63.5,54.65,47.53,63.68,71.04000000000001,59.18,81.8,65.40000000000001,74.13,60.07,35.89,58.77,50.53,69.97,50.51,56.74,50.84,40.54,25.03,64.29000000000001,49.71,52.45,65.09999999999999,46.48,53.69,60.83,61.91,36.16,65.94,52.97,41.3,57.83,52.52,52.39,66.81,47.01,53.83,86.31999999999999,63.66,70.06999999999999,61.08,74.54000000000001,83.95999999999999,64.98,73.40000000000001,63.21,55.26,35.72,75.05,47.63,61.29,36.44,57.86,59.47,63.72,30.57,60.18,38.8,50.81,40.19,50.09,63.4,71.58,63.69,17.13,60.56,74.2,57.46,33.19,52.93,73.04000000000001,70.08,40.42,54.62,47.69,58.33,54.35,49.73,77.51000000000001,38.37,51.49,58.2,56.45,49.46,39.25,28.9,60.31,50.31,67.33,35.14,67.95,30.44,71.73999999999999,51.28,50.92,65.58,51.73,75.38,45.84,67.81,34.34,41.9,49.38,40.22,45.55,44.48,39.65,35.2,33.38,33.67,73.98999999999999,60.52,75.70999999999999,48.04,42.13,38.03,27.02,33.34,70.34,50.58,66.7,57.49,63.15,65.5,50.98,79.68000000000001,71.31,49.98,31.48,55.35,78.16,50.9,52.33,54.93,55.34,77.25,48.54,55.94,49.1,28.03,24.92,37.77,57.28,67.97,43.89,39.85,40.25,40.91,54.89,41.37,57.43,73.29000000000001,55.55,37.22,61.28,55.45,54.58,57.8,63.42,66.43000000000001,50.84,49.03,51.61,55.62,45.68,37.7,66.66,52.76,63.98,71.20999999999999,73.91,77.09999999999999,54.42,62.57,40.08,58.08,61.69,59.67,70.66,74.67,54.83,48.96,49.63,63.87,74.98,60.3,43.86,48.35,60.8,67.67,83.09,53.37,23.06,48.38,49,45.88,36.66,27.85,52.63,52.54,38.33,34.4,35.55,56.29,36.82,30.18,67.54000000000001,39.44,38.07,45.17,46.7,38.21,50.75,50.57,53.08,49.52,71.81,49.77,53.68,46.68,62.65,61.05,72.81,53.85,61.04,54.95,54.75,92.45999999999999,57.34,43.46,27.89,67.42,53.67,78.95,46.77,67.34999999999999,64.70999999999999,54.97,71.31,61.18,37.84,58.26,28.23,80.13,81.62,55.37,49.39,1.24,69.7,61.12,57.73,81.36,59.91,59.15,68.22,69.66,54.86,43.19,59.27,45.46,54.21,45.13,54.61,69.14,51.35,25.6,62.18,73.81999999999999,31.9,56.27,52.86,55.59,77.06,87.55,46.6,69.38,36.44,38.39,61.6,58.07,34.41,38.92,51.91,35.2,58.01,54.11,26.06,46.86,37.97,48.56,42.58,38.95,42.88,65.7,49.36,57.68,60.86,64.02,51.45,53.15,56.61,35.27,49.16,45.97,50.05,71.48999999999999,65.91,83.87,66.20999999999999,23.44,75.39,76.45,67.78,41.13,57.76,69.59,41.16,69.61,63.23]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>student_id<\/th>\n      <th>n_lectures<\/th>\n      <th>year<\/th>\n      <th>n_record<\/th>\n      <th>overall_grade<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,4,5]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"student_id","targets":1},{"name":"n_lectures","targets":2},{"name":"year","targets":3},{"name":"n_record","targets":4},{"name":"overall_grade","targets":5}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><br></p>
<p>The <code>year</code> variable is a categorical variable with more than two levels. We’re going to convert it into a factor:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>attend_tib <span class="ot">&lt;-</span> attend_tib <span class="sc">|&gt;</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">year =</span> <span class="fu">factor</span>(year)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For the comparison specified in the hypothesis, we want “Year 1” to be coded as the baseline against which to compare the other two years. We can check the order of our levels with the <code>levels()</code> function:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(attend_tib<span class="sc">$</span>year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>code [1] "Year 1" "Year 2" "Year 3"</code></pre>
</div>
</div>
<p>“Year 1” is listed first, which means that R will use it as the baseline group. We don’t need to do anything else here, but if the groups weren’t in the correct order, we’d need to reorder them with the <code>forecats::fct_relevel()</code> function.</p>
</section>
<section id="descriptives-and-data-viz" class="level3">
<h3 class="anchored" data-anchor-id="descriptives-and-data-viz">Descriptives and data viz</h3>
<p>We’re using the same code as usual for the descriptives. We’re also adding an argument <code>include_factors = TRUE</code> so that we get some summaries for the categorical variables.</p>
<div id="tbl-count-desc" class="cell anchored" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">describe_distribution</span>(attend_tib, <span class="at">include_factors =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">display</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 14%">
<col style="width: 10%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 18%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 5%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: center;">Mean</th>
<th style="text-align: center;">SD</th>
<th style="text-align: center;">IQR</th>
<th style="text-align: center;">Range</th>
<th style="text-align: center;">Skewness</th>
<th style="text-align: center;">Kurtosis</th>
<th style="text-align: center;">n</th>
<th style="text-align: center;">n_Missing</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">student_id</td>
<td style="text-align: center;">24937.43</td>
<td style="text-align: center;">2884.07</td>
<td style="text-align: center;">5132.00</td>
<td style="text-align: center;">(20026, 29973)</td>
<td style="text-align: center;">0.03</td>
<td style="text-align: center;">-1.21</td>
<td style="text-align: center;">584</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">n_lectures</td>
<td style="text-align: center;">1.33</td>
<td style="text-align: center;">1.64</td>
<td style="text-align: center;">2.00</td>
<td style="text-align: center;">(0, 10)</td>
<td style="text-align: center;">1.64</td>
<td style="text-align: center;">3.07</td>
<td style="text-align: center;">584</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">year</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">(Year 1, Year 3)</td>
<td style="text-align: center;">0.18</td>
<td style="text-align: center;">2.17</td>
<td style="text-align: center;">584</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">n_record</td>
<td style="text-align: center;">5.26</td>
<td style="text-align: center;">1.63</td>
<td style="text-align: center;">2.00</td>
<td style="text-align: center;">(0, 11)</td>
<td style="text-align: center;">0.08</td>
<td style="text-align: center;">0.13</td>
<td style="text-align: center;">584</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">overall_grade</td>
<td style="text-align: center;">54.58</td>
<td style="text-align: center;">13.49</td>
<td style="text-align: center;">17.05</td>
<td style="text-align: center;">(0, 96.57)</td>
<td style="text-align: center;">-0.19</td>
<td style="text-align: center;">0.55</td>
<td style="text-align: center;">584</td>
<td style="text-align: center;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><br></p>
<p>Some things of note - the average number of lectures attended is <em>extremely low</em> - less than two out of 11 lectures. This variable is also quite skewed and has excess kurtosis. Let’s see what it looks like. To spice things up, we’ll create a nice histogram this time, overlayed by a count line. If you’re copying and adjusting code, try copying line by line so you can see the changes gradually:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="annotated-cell-7"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><a class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-7-1" class="code-annotation-target"><a href="#annotated-cell-7-1" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">data =</span> attend_tib, <span class="fu">aes</span>(<span class="at">x =</span> n_lectures)) <span class="sc">+</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-7-2" class="code-annotation-target"><a href="#annotated-cell-7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"yellowgreen"</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-7-3" class="code-annotation-target"><a href="#annotated-cell-7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">stat =</span> <span class="st">"count"</span>) <span class="sc">+</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="4" onclick="event.preventDefault();">4</a><span id="annotated-cell-7-4" class="code-annotation-target"><a href="#annotated-cell-7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">stat =</span> <span class="st">"count"</span>) <span class="sc">+</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="5" onclick="event.preventDefault();">5</a><span id="annotated-cell-7-5" class="code-annotation-target"><a href="#annotated-cell-7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">11</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="6" onclick="event.preventDefault();">6</a><span id="annotated-cell-7-6" class="code-annotation-target"><a href="#annotated-cell-7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-7" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="1" data-code-annotation="1">Create the base layer, placing the number of layers on the x axis</span>
</dd>
<dt data-target-cell="annotated-cell-7" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="2" data-code-annotation="2">Add the histogram. We’re also changing the default colour and we’re making it a little transparent. This is optional (but looks nice)</span>
</dd>
<dt data-target-cell="annotated-cell-7" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="3" data-code-annotation="3">Add a line. Set the statistic used for calculating the values to be a “count”.</span>
</dd>
<dt data-target-cell="annotated-cell-7" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="4" data-code-annotation="4">Add points. We can make them a little larger using the <code>size</code> argument. As above, we’re requesting the “count” statistic.</span>
</dd>
<dt data-target-cell="annotated-cell-7" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="5" data-code-annotation="5">Change the scale to make sure the breaks are only at whole numbers and not at places with decimal points. We could just list all the numbers for the <code>breaks</code> argument - e.g.&nbsp;<code>c(1,2,3,4,5,6,7,8,9,10,11)</code> - but it’s more efficient to request a sequence of numbers starting at 0, going up to 11 (because that’s how many lectures there were in total), increasing by 1 at each step: <code>seq(0, 11, 1)</code> .</span>
</dd>
<dt data-target-cell="annotated-cell-7" data-target-annotation="6">6</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="6" data-code-annotation="6">Add a nice theme.</span>
</dd>
</dl>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="01b_gzlms_counts_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Often the histogram itself is enough to give us the necessary info. However with count variables, adding the line and the points can be used to show that the outcome variable is indeed a count variable <em>and that we’re going to treat it as such</em> (as opposed to treating it as continuous.</p>
<p>We can see that we have a right skewed distribution. Quite a lot of students did not attend any lectures at all or they went to just one. Very few participants attended 10 lectures, and no-one attended all of them (number 11 doesn’t even show up on the plot unless we force the plot to do so).</p>
<p>For the hypothesis, we can create a dot plot instead of a scatter plot (because we have a categorical predictor):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="annotated-cell-8"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><a class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-8-1" class="code-annotation-target"><a href="#annotated-cell-8-1" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">data =</span> attend_tib, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> n_lectures)) <span class="sc">+</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-8-2" class="code-annotation-target"><a href="#annotated-cell-8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>), <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">colour =</span> <span class="st">"yellowgreen"</span>) <span class="sc">+</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-8-3" class="code-annotation-target"><a href="#annotated-cell-8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">colour =</span> <span class="st">"steelblue"</span>, <span class="at">fun.data =</span> <span class="st">"mean_cl_normal"</span>) <span class="sc">+</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="4" onclick="event.preventDefault();">4</a><span id="annotated-cell-8-4" class="code-annotation-target"><a href="#annotated-cell-8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">11</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="annotated-cell-8-5"><a href="#annotated-cell-8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() </span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-8" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="1" data-code-annotation="1">Set up the base layer. The predictor <code>year</code> goes on the x axis, the outcome goes on the y axis.</span>
</dd>
<dt data-target-cell="annotated-cell-8" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="2" data-code-annotation="2">Add the points. We’re tweaking the default settings so the distribution of the points is a little easier to see. For <code>position</code> we’re setting “position_jitter” which ensures the points are not stacked on top of each other. The <code>width</code> argument defines how far out the points spread. We’re also changing the transparency <code>alpha</code> to 0.2 so we can see more of the points. Finally, we change the colour.</span>
</dd>
<dt data-target-cell="annotated-cell-8" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="3" data-code-annotation="3"><code>stat_summary</code> adds the means and the confidence intervals - we request this by specifying “mean_cl_normal” in the <code>fun.data</code> argument. When choosing colour, pick something that contrasts well with the scatter points in the background.</span>
</dd>
<dt data-target-cell="annotated-cell-8" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="4" data-code-annotation="4">Scale the y axis so it only shows whole numbers.</span>
</dd>
</dl>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="01b_gzlms_counts_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Based on the plot, it seems like Year 1 students have the best attendance (though also have the fewest data points and therefore the widest confidence intervals), followed by Year 2 and Year 3, who attend the fewest sessions.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
FYI: Plotting a continuous predictor
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In case we need to plot a continuous predictor, we can add a line of best fit in the same way as we did for the Gamma model, changing the <code>methods.args</code> option to a different distribution. For example:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">data =</span> attend_tib, <span class="fu">aes</span>(<span class="at">x =</span> overall_grade, <span class="at">y =</span> n_lectures)) <span class="sc">+</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>), <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">colour =</span> <span class="st">"yellowgreen"</span>) <span class="sc">+</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"glm"</span>, <span class="at">colour =</span> <span class="st">"steelblue"</span>, <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> <span class="st">"poisson"</span>)) <span class="sc">+</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>code `geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="01b_gzlms_counts_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="poisson-models" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="poisson-models"><span class="header-section-number">2.1</span> Poisson models</h2>
<p>More often than not, a distribution is defined by some version of two parameters - location and dispersion. Location tells us at which point to centre the distribution and dispersion tells us how far the points spread out. In a Gaussian distribution, we have the mean and the standard deviation. In Gamma models, we have shape and scale. They’re not exactly the same, but they serve a similar function.</p>
<p>Poisson models are simple creatures. They are only defined by one parameter <span class="math inline">\(\lambda\)</span> (lambda) which represents <em>both</em> the location and the dispersion. This is because of the <a href="01_gzlms.html#sec-mean-variance-relationship">mean-variance relationship</a> the models assume:</p>
<p><span class="math display">\[
V(Y) = E(Y)
\]</span></p>
<p>In which the variance of Y (the outcome) will always be equal to the expected value of Y. This is in contrast with the Gaussian models, which don’t assume a specific value as long as it’s constant (homoscedastic), or the Gamma models in which variance is equal to the square of the expected value.</p>
<p>As a result, they’re nice and simple to simulate:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="annotated-cell-9"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><a class="code-annotation-anchor" data-target-cell="annotated-cell-9" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-9-1" class="code-annotation-target"><a href="#annotated-cell-9-1" aria-hidden="true" tabindex="-1"></a>poisson_dist <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">lambda =</span> <span class="dv">1</span>)</span>
<span id="annotated-cell-9-2"><a href="#annotated-cell-9-2" aria-hidden="true" tabindex="-1"></a></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-9" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-9-3" class="code-annotation-target"><a href="#annotated-cell-9-3" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="cn">NULL</span>, <span class="fu">aes</span>(<span class="at">x =</span> poisson_dist)) <span class="sc">+</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-9" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-9-4" class="code-annotation-target"><a href="#annotated-cell-9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-9" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-9" data-code-lines="1" data-code-annotation="1">Generate 1000 random numbers drawn from a Poisson distribution with the lambda parameter equal to 1. Save the result into an object called <code>poisson_dist</code> .</span>
</dd>
<dt data-target-cell="annotated-cell-9" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-9" data-code-lines="3" data-code-annotation="2">Add <code>poisson_dist</code> into the base layer of a plot</span>
</dd>
<dt data-target-cell="annotated-cell-9" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-9" data-code-lines="4" data-code-annotation="3">Draw a histogram.</span>
</dd>
</dl>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="01b_gzlms_counts_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>As expected, the distribution only generates integers (or whole numbers). We can confirm this with the <code>head()</code> function, which will print out the first six values from the object we enter into it:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(poisson_dist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 3 0 0 3 1</code></pre>
</div>
</div>
<p>The distribution is also right skewed. A Poisson distribution can only be right skewed or symmetrical. The larger the lambda parameter, the more symmetrical the distribution will be:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>poisson_dist <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">lambda =</span> <span class="dv">10</span>) </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="cn">NULL</span>, <span class="fu">aes</span>(<span class="at">x =</span> poisson_dist)) <span class="sc">+</span> </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="01b_gzlms_counts_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Note that even if the distribution achieves perfect symmetry, we still can’t call it normal, because the values are not on a continuous scale (and there are other requirements a normal distribution has, other than symmetry).</p>
<p>Conversely, lambda can be smaller than 1, in which case the skew becomes more extreme and values will be bunched up around the lower end of the scale:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>poisson_dist <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">lambda =</span> <span class="fl">0.5</span>) </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="cn">NULL</span>, <span class="fu">aes</span>(<span class="at">x =</span> poisson_dist)) <span class="sc">+</span> </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="01b_gzlms_counts_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This mean-variance relationship is <em>very</em> restrictive. Realistically, there aren’t many variables that strictly follow a Poisson distribution, but let’s not doom our model before we’ve given it a chance (spoiler alert…).</p>
<section id="fit-the-model" class="level3">
<h3 class="anchored" data-anchor-id="fit-the-model">Fit the model</h3>
<p>We can fit the model using the <code>glm</code> function.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="annotated-cell-13"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-13-1"><a href="#annotated-cell-13-1" aria-hidden="true" tabindex="-1"></a>attend_poiss <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-13" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-13-2" class="code-annotation-target"><a href="#annotated-cell-13-2" aria-hidden="true" tabindex="-1"></a>  n_lectures <span class="sc">~</span> year <span class="sc">+</span> n_record <span class="sc">+</span> overall_grade,</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-13" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-13-3" class="code-annotation-target"><a href="#annotated-cell-13-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> attend_tib,</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-13" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-13-4" class="code-annotation-target"><a href="#annotated-cell-13-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>)</span>
<span id="annotated-cell-13-5"><a href="#annotated-cell-13-5" aria-hidden="true" tabindex="-1"></a>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-13" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-13" data-code-lines="2" data-code-annotation="1">Specify the formula</span>
</dd>
<dt data-target-cell="annotated-cell-13" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-13" data-code-lines="3" data-code-annotation="2">Specify the dataset</span>
</dd>
<dt data-target-cell="annotated-cell-13" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-13" data-code-lines="4" data-code-annotation="3">Set the family to be <code>poisson</code> . The link function is <code>log</code> - same as for the Gamma models.</span>
</dd>
</dl>
</div>
</div>
</section>
<section id="evaluate-the-model-fit" class="level3">
<h3 class="anchored" data-anchor-id="evaluate-the-model-fit">Evaluate the model fit</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(attend_poiss)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="01b_gzlms_counts_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>First, let’s go through the plots we already know.</p>
<ul>
<li><p><strong>Posterior predictive check</strong> - we no longer see the smooth curves - this is not a problem, because we’re not working with continuous data. The predictions themselves are not great. The model predicts fewer counts for values 0, 1, and 2than observed. The predictions are fine from 3 onward, but that left tail is quite inaccurate.</p></li>
<li><p><strong>Homogeneity of variance</strong> - looks a little funky because of the criss-crossy pattern. Again, this is not a problem and caused by the fact that we’re working with counts. The line isn’t entirely flat, but overall not too wobbly. I’d say the model passes the <del>vibe</del> diagnostic check on this criterion.</p></li>
<li><p><strong>Influential observations</strong> - nothing flagged here.</p></li>
<li><p><strong>Collinearity</strong> - all VIF values are low and not a cause for concern</p></li>
<li><p><strong>Uniformity of residuals</strong> - the points wobble around the line.</p></li>
</ul>
<p>Based on the posterior predictive check and the residuals, it seems like the model is not a great fit. This is confirmed by the plot that we skipped, which checks for <strong>over-dispersion</strong>.</p>
</section>
<section id="over-dispersion" class="level3">
<h3 class="anchored" data-anchor-id="over-dispersion">Over-dispersion</h3>
<p>Let’s take a closer look at this plot:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="01b_gzlms_counts_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The straight blue line represents what kind of variance the model expects for different predicted values. Recall that the mean-variance relationship is:</p>
<p><span class="math display">\[
V(Y) = E(Y)
\]</span></p>
<p>It’s a little difficult to see on the plot, but the line is plotted in a way where the value 1 on the x axis corresponds to the value of 1 on the y axis. Value 2 on x represents to 2 on y, and so on. We need the variance in our model (the green line with the ribbon) to follow this line. We can see that this is not the case. The green line wiggles <em>above</em> the straight line most of the time. This means that there is more dispersion in our model then the Poisson model allows - it is over-dispersed.</p>
<p>Although this case is pretty cut and dry, we can use the over-dispersion test from <code>easystats</code> to get a second opinion:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_overdispersion</span>(attend_poiss)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>code # Overdispersion test
code 
code        dispersion ratio =    1.927
code   Pearson's Chi-Squared = 1115.938
code                 p-value =  &lt; 0.001</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>code Overdispersion detected.</code></pre>
</div>
</div>
<p>For a Poisson model, we’d expect the dispersion ratio to be 1. If it’s above 1, the model is over-dispersed, if it’s below 1, it’s under-dispersed. A <em>p</em>-value tells us whether this deviation from 1 is statistically significant.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Significance tests of assumptions
</div>
</div>
<div class="callout-body-container callout-body">
<p>Generally, significance tests of assumptions are not the best idea because they because they encourage black and white thinking (over-dispersed vs under-dispersed) instead of nuanced evaluation. The dispersion ratio itself <em>is</em> a useful indicator of the amount of dispersion we have, however the <em>p</em>-values can be misleading. In larger samples, they will be more likely to sound an alarm even if the violation is minor. They might be helpful in an ambiguous situation where the plot isn’t clear, but even then a problem in one diagnostic plot will likely be echoed in at least one other plot.</p>
</div>
</div>
<p>Under over-dispersion, the parameter estimates are valid, however the standard errors (and therefore confidence intervals and <em>p</em>-values) are not. On the whole, this model is clearly not well specified. We have some alternatives. Again, ideally we want to think about whether a distribution is suitable for our data <em>before</em> we even collected the data, and certainly before we start mucking about with the data in the analysis stage. But let’s say that we’ve miscalculated. What are our options? Well, we still have:</p>
<ul>
<li><p>Negative binomial models</p></li>
<li><p>Quasi-Poisson models</p></li>
</ul>
</section>
</section>
<section id="negative-binomial-models" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="negative-binomial-models"><span class="header-section-number">2.2</span> Negative binomial models</h2>
<p>Negative binomial (NB) distribution allows us to model counts in situations where dispersion is is greater than the expected mean. Unlike Poisson, NB distribution has a separate dispersion parameter that allows the model to be a little more flexible. The variance (V) is modelled as:</p>
<p><span class="math display">\[
V(Y) = E(Y) + \frac{E(Y)^2}{k}
\]</span></p>
<p>Which is the sum of the expected value of Y plus the square of the expected value divided by the dispersion parameter <em>k</em> . The <em>k</em> parameter therefore controls how far the values spread out. The smaller the <em>k</em>, the larger the dispersion and the extent of skewness are going to be (because dividing by a small number results in a larger number).</p>
<p>In the code below, the <code>theta</code> argument represents the <em>k</em> parameter:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>nb_dist <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">rnegbin</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">mu =</span> <span class="dv">1</span>, <span class="at">theta =</span> <span class="fl">0.5</span>) </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="cn">NULL</span>, <span class="fu">aes</span>(<span class="at">x =</span> nb_dist)) <span class="sc">+</span> </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="01b_gzlms_counts_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Conversely, we can set <code>theta</code> to be very large, in which case the NB distribution will start to resemble the Poisson distribution. This is because we divide by a large number, so the fraction <span class="math inline">\(\frac{E(Y)^2}{k}\)</span> will result in a very small value, and the variance will be very close to the value of the mean.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>nb_dist <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">rnegbin</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">mu =</span> <span class="dv">1</span>, <span class="at">theta =</span> <span class="dv">100</span>) </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="cn">NULL</span>, <span class="fu">aes</span>(<span class="at">x =</span> nb_dist)) <span class="sc">+</span> </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="01b_gzlms_counts_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="fit-the-model-1" class="level3">
<h3 class="anchored" data-anchor-id="fit-the-model-1">Fit the model</h3>
<p>Let’s try this again, shall we? The function is a little different this time - we’re using the <code>glm.nb</code> from the package <code>MASS</code> to fit a negative binomial model. We still need to specify the formula and the data, but we don’t need to specify the family because <code>glm.nb</code> function can only fit negative binomial models:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>attend_nb <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">glm.nb</span>(</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  n_lectures <span class="sc">~</span> n_record <span class="sc">+</span> year <span class="sc">+</span> overall_grade, </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> attend_tib</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="evaluate-the-model-fit-1" class="level3">
<h3 class="anchored" data-anchor-id="evaluate-the-model-fit-1">Evaluate the model fit</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(attend_nb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="01b_gzlms_counts_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p><strong>Posterior predictive check</strong> - this is a <em>much</em> better fit then before.</p></li>
<li><p><strong>Homogeneity of variance:</strong> looks fine</p></li>
<li><p><strong>Influential cases:</strong> none detected</p></li>
<li><p><strong>Collinearity:</strong> none detected</p></li>
<li><p><strong>Residuals</strong> - follow the line nicely.</p></li>
<li><p><strong>Dispersion</strong>… wrong way around! This time, the variance is increasing at a slower rate than the model expects, as the green line with the ribbon departs from the predicted blue line around 1.5 on the x axis and continues below it. This is called <strong>under-dispersion</strong>. Again. the predictions and parameter estimates might be accurate, but if we care about inferential stats (let’s say that we do), we’re running the risk of basic our decisions on inaccurate <em>p</em>-values.</p></li>
</ul>
</section>
</section>
<section id="quasi-poisson-models" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="quasi-poisson-models"><span class="header-section-number">2.3</span> Quasi-Poisson models</h2>
<p>A third type of model we’re going to try is the Quasi-Poisson model. Strictly speaking, Quasi-Poisson models don’t belong to the GLM family, but they are very GLM like, in that:</p>
<ol type="1">
<li>They apply linearising link function to model the relationships of interest. This function is the natural logarithm, same as for Gamma and Poisson models.</li>
<li>They assume a mean-variance relationship, specifically that <span class="math inline">\(V(Y) = \phi E(Y)\)</span> . In Poisson models, the <span class="math inline">\(\phi\)</span> parameter is assumed to be 1, and therefore the variance is equal to the expected value. In Quasi-Poisson models, <span class="math inline">\(\phi\)</span> is estimated from the data and can be different from 1. The larger the <span class="math inline">\(\phi\)</span> the larger the variance.</li>
<li>We fit them with the <code>glm</code> function.</li>
</ol>
<p>Unfortunately, we can’t really simulate a Quasi-Poisson distribution to show how it changes with a changing <span class="math inline">\(\phi\)</span>, because such a distribution doesn’t exist. In this sense, the models are different from GLM:</p>
<ul>
<li><p>Because a Quasi-Poisson distribution doesn’t exist, the estimation cannot be based on Maximum Likelihood. It is based on Quasi-Likelihood.</p></li>
<li><p>Instead, the parameters are estimated in the same way, but in addition we need to estimate the <span class="math inline">\(\phi\)</span> parameter, which is then used to adjust the standard errors, ensuring the inference (i.e.&nbsp;the <em>p</em>-values) is valid.</p></li>
</ul>
<p>Because of the way <span class="math inline">\(\phi\)</span> is estimated, the model can deal with over- or under dispersion. If we were to use robust models as a metaphor for Quasi-likelihood models, they’re a similar level of fix as heteroscedasticity-consistent standard errors (e.g.&nbsp;“HC4”, “HC5”) - when we apply the HC4 correction, the parameter estimates are not affected, but the standard errors change because they are estimated from the model predictor matrix rather then based on an assumption of constant variance.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The drawbacks of Quasi-models
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The general guidance is that we should use negative-binomial models when we have over-dispersed data, and only resolve to Quasi-Poisson if the issues with dispersion aren’t fixed under the NB distribution.</p>
<p>Main reason being is that Quasi-likelihood models rob us of some of the benefits of full-likelihood models, such as the ability to compare models and evaluate improvement after adding predictors.</p>
<p>For example, imagine that we built our NB models bit by bit, by adding the predictors one after another:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>attend_0 <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">glm.nb</span>(n_lectures <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> attend_tib)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>attend_1 <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">glm.nb</span>(n_lectures <span class="sc">~</span> year, <span class="at">data =</span> attend_tib)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>attend_2 <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">glm.nb</span>(n_lectures <span class="sc">~</span> year <span class="sc">+</span> n_record, <span class="at">data =</span> attend_tib)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>attend_3 <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">glm.nb</span>(n_lectures <span class="sc">~</span> year <span class="sc">+</span> n_record <span class="sc">+</span> overall_grade, <span class="at">data =</span> attend_tib)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can then compare these models based on AIC, BIC, and pseudo R<sup>2</sup> :</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compare_performance</span>(attend_0, attend_1, attend_2, attend_3, <span class="at">metrics =</span> <span class="st">"common"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">display</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 24%">
<col style="width: 24%">
<col style="width: 21%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Name</th>
<th style="text-align: center;">Model</th>
<th style="text-align: center;">AIC (weights)</th>
<th style="text-align: center;">BIC (weights)</th>
<th style="text-align: center;">Nagelkerke’s R2</th>
<th style="text-align: center;">RMSE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">attend_0</td>
<td style="text-align: center;">negbin</td>
<td style="text-align: center;">1861.1 (&lt;.001)</td>
<td style="text-align: center;">1869.8 (6.00e-03)</td>
<td style="text-align: center;">2.04e-15</td>
<td style="text-align: center;">1.64</td>
</tr>
<tr class="even">
<td style="text-align: left;">attend_1</td>
<td style="text-align: center;">negbin</td>
<td style="text-align: center;">1843.4 (0.01)</td>
<td style="text-align: center;">1860.9 (0.48)</td>
<td style="text-align: center;">0.06</td>
<td style="text-align: center;">1.61</td>
</tr>
<tr class="odd">
<td style="text-align: left;">attend_2</td>
<td style="text-align: center;">negbin</td>
<td style="text-align: center;">1845.3 (5.00e-03)</td>
<td style="text-align: center;">1867.2 (0.02)</td>
<td style="text-align: center;">0.06</td>
<td style="text-align: center;">1.61</td>
</tr>
<tr class="even">
<td style="text-align: left;">attend_3</td>
<td style="text-align: center;">negbin</td>
<td style="text-align: center;">1834.6 (0.98)</td>
<td style="text-align: center;">1860.8 (0.49)</td>
<td style="text-align: center;">0.09</td>
<td style="text-align: center;">1.60</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We can see that Model 2 (in which we added the <code>n_record</code> predictor) is not really an improvement compared to the previous models. Generally, we’re looking for a model with the lowest AIC and BIC. We can also see that the <span class="math inline">\(R^2\)</span> value doesn’t change from Model 1 to Model 2, but does improve for Model 3.</p>
<p>We can confirm this with a likelihood ratio test:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(attend_0, attend_1, attend_2, attend_3) <span class="sc">|&gt;</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">display</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 33%">
<col style="width: 6%">
<col style="width: 10%">
<col style="width: 16%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Model</th>
<th style="text-align: left;">theta</th>
<th style="text-align: right;">Resid. df</th>
<th style="text-align: right;">2 x log-lik.</th>
<th style="text-align: right;">Test</th>
<th style="text-align: right;">df</th>
<th style="text-align: right;">LR stat.</th>
<th style="text-align: right;">Pr(Chi)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">1.212</td>
<td style="text-align: right;">583</td>
<td style="text-align: right;">-1857.067</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">year</td>
<td style="text-align: left;">1.342</td>
<td style="text-align: right;">581</td>
<td style="text-align: right;">-1835.397</td>
<td style="text-align: right;">1 vs 2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">21.670</td>
<td style="text-align: right;">1.970e-05</td>
</tr>
<tr class="odd">
<td style="text-align: left;">year + n_record</td>
<td style="text-align: left;">1.342</td>
<td style="text-align: right;">580</td>
<td style="text-align: right;">-1835.317</td>
<td style="text-align: right;">2 vs 3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.081</td>
<td style="text-align: right;">0.777</td>
</tr>
<tr class="even">
<td style="text-align: left;">year + n_record + overall_grade</td>
<td style="text-align: left;">1.422</td>
<td style="text-align: right;">579</td>
<td style="text-align: right;">-1822.621</td>
<td style="text-align: right;">3 vs 4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">12.695</td>
<td style="text-align: right;">3.666e-04</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Here, the last column contains the p-value that tells us whether each model is a significant improvement compared to the previous model. The <em>p</em>-value for Model 2 is not statistically significant.</p>
<p>If likelihood-based comparisons are something we’re interested in, then we cannot use Quasi-Poisson model for estimation. But if we only want to estimate the parameters and make valid inference, they’re a good solution for dealing with over- or under-dispersion.</p>
</div>
</div>
</div>
<section id="fit-the-model-2" class="level3">
<h3 class="anchored" data-anchor-id="fit-the-model-2">Fit the model</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>attend_qpoiss <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  n_lectures <span class="sc">~</span> year <span class="sc">+</span> n_record  <span class="sc">+</span> overall_grade, </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> attend_tib, </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">quasipoisson</span>(<span class="at">link =</span> <span class="st">"log"</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="evaluate-the-model-fit-2" class="level3">
<h3 class="anchored" data-anchor-id="evaluate-the-model-fit-2">Evaluate the model fit</h3>
<p>We don’t actually gain any additional insight from the <code>model_check</code> function - it will still tell us that there is over-dispersion based on the Poisson expectations, and the residuals will still indicate a suboptimal fit (because the check also expects a Poisson distribution). The posterior predictive check disappears, because there’s no theoretical distribution based on which to make predictions. The model fit statistics will also be based on the Poisson distribution, not on Quasi-Poisson. The only thing that is unique to Quasi-Poisson is the standard errors and <em>p</em>-values.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(attend_qpoiss)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="01b_gzlms_counts_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>This highlights the fact that a Quasi-Poisson is a “fix” to a problem and more of contingency, rather than a model that can be thoughtfully planned in advance. By default, we should aim for Poisson if it’s realistic, Negative-Binomial if we’re expecting over-dispersion, and only resort to Quasi-Poisson if the original plan fails.</p>
<p>Either way, our options are not ideal. The NB model offers more accurate prediction but the standard errors and <em>p</em>-values will be inaccurate. Conversely, the Quasi-Poisson model generates valid inferential stats but the prediction will not be as accurate, especially for individuals with the lowest attendance.</p>
<p>We’re going stick with the Quasi-Poisson model for now, just to go over what the output looks like. The interpretation of the parameter estimates for all the models introduced so far is the same.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(attend_qpoiss) <span class="sc">|&gt;</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">display</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Nagelkerke’s R2</th>
<th style="text-align: center;">RMSE</th>
<th style="text-align: center;">Sigma</th>
<th style="text-align: center;">Score_log</th>
<th style="text-align: center;">Score_spherical</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0.13</td>
<td style="text-align: center;">1.60</td>
<td style="text-align: center;">1.39</td>
<td style="text-align: center;">-1.67</td>
<td style="text-align: center;">0.04</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_wald</span>(attend_qpoiss) <span class="sc">|&gt;</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">display</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Name</th>
<th style="text-align: right;">Model</th>
<th style="text-align: left;">df</th>
<th style="text-align: right;">df_diff</th>
<th style="text-align: right;">F</th>
<th style="text-align: right;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Null model</td>
<td style="text-align: right;">glm</td>
<td style="text-align: left;">583</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Full model</td>
<td style="text-align: right;">glm</td>
<td style="text-align: left;">579</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">9.091</td>
<td style="text-align: right;">&lt; .001</td>
</tr>
</tbody>
</table>
<p>Models were detected as nested (in terms of fixed parameters) and are compared in sequential order.</p>
</div>
</div>
<p><br></p>
<p>Overall, the model explains 12.71% percent of deviance and is a significant improvement over the null model <em>F</em>(4,579) = 9.09, <em>p</em> &lt; .001.</p>
</section>
<section id="extract-model-parameters" class="level3">
<h3 class="anchored" data-anchor-id="extract-model-parameters">Extract model parameters</h3>
<p>Once again, we exponentiate the parameter estimates so that we can interpret them with reference to the original scale:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>attend_qpoiss <span class="sc">|&gt;</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">display</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: center;">IRR</th>
<th style="text-align: center;">SE</th>
<th style="text-align: center;">95% CI</th>
<th style="text-align: center;">t(579)</th>
<th style="text-align: center;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: center;">0.989</td>
<td style="text-align: center;">0.308</td>
<td style="text-align: center;">(0.534, 1.809)</td>
<td style="text-align: center;">-0.034</td>
<td style="text-align: center;">0.973</td>
</tr>
<tr class="even">
<td style="text-align: left;">year (Year 2)</td>
<td style="text-align: center;">0.631</td>
<td style="text-align: center;">0.094</td>
<td style="text-align: center;">(0.476, 0.854)</td>
<td style="text-align: center;">-3.087</td>
<td style="text-align: center;">0.002</td>
</tr>
<tr class="odd">
<td style="text-align: left;">year (Year 3)</td>
<td style="text-align: center;">0.346</td>
<td style="text-align: center;">0.084</td>
<td style="text-align: center;">(0.212, 0.550)</td>
<td style="text-align: center;">-4.384</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">n record</td>
<td style="text-align: center;">1.008</td>
<td style="text-align: center;">0.030</td>
<td style="text-align: center;">(0.950, 1.070)</td>
<td style="text-align: center;">0.267</td>
<td style="text-align: center;">0.789</td>
</tr>
<tr class="odd">
<td style="text-align: left;">overall grade</td>
<td style="text-align: center;">1.013</td>
<td style="text-align: center;">0.004</td>
<td style="text-align: center;">(1.006, 1.020)</td>
<td style="text-align: center;">3.452</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><br></p>
<p>If we wanted to, we could calculate the percentage change for all the parameters and their confidence intervals, by folowing the steps in the section <a href="01a_gzlms_skewed.html#sec-gamma-params">Parameter estimates</a> from the previous tutorial. Here, we’ll just focus on the estimates relevant to the hypothesis.</p>
</section>
<section id="interpretation" class="level3">
<h3 class="anchored" data-anchor-id="interpretation">Interpretation</h3>
<p>The main predictor has three categories. We haven’t specified any contrasts<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> so the output will compare two categories against the baseline. In our case, we previously set Year 1 to be the baseline, so Years 2 and 3 are compared against it.</p>
<p>The estimate for the Year 2 vs Year 1 comparison is 0.631. It is smaller that 1, which means that lecture attendance was lower for Year 2. We can convert it into a percentage by multiplying by 100, getting 63.1. This means that Year 2 attendance represents 63.1 percent of Year 1 attendance. If we wanted to calculate the difference, we subtract 100: 63.1 - 100 = -36.9. Therefore lecture attendance for Year 2 was -36.9% lower compared to Year 1. For Year 3, the attendance was -65.4% lower than Year 1 attendance.</p>
<p>For continuous predictors we’re back to a change in the outcome associated with a one unit increase in the predictor. For example, grade is positively associated with attendance. With each unit increase in grade, attendance increases by 1.3%. This seems small but remember that grade is measured on 100 point scale. We could generate some predictions to put this into perspective:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="annotated-cell-25"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><a class="code-annotation-anchor" data-target-cell="annotated-cell-25" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-25-1" class="code-annotation-target"><a href="#annotated-cell-25-1" aria-hidden="true" tabindex="-1"></a>prediction_tib <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-25" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-25-2" class="code-annotation-target"><a href="#annotated-cell-25-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="st">"Year 1"</span> <span class="sc">|&gt;</span> <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Year 1"</span>, <span class="st">"Year 2"</span>, <span class="st">"Year 3"</span>)),</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-25" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-25-3" class="code-annotation-target"><a href="#annotated-cell-25-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_record =</span> <span class="fl">5.26</span>,</span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-25" data-target-annotation="4" onclick="event.preventDefault();">4</a><span id="annotated-cell-25-4" class="code-annotation-target"><a href="#annotated-cell-25-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">overall_grade =</span> <span class="dv">30</span>,</span>
<span id="annotated-cell-25-5"><a href="#annotated-cell-25-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="annotated-cell-25-6"><a href="#annotated-cell-25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-25-7"><a href="#annotated-cell-25-7" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>( </span>
<span id="annotated-cell-25-8"><a href="#annotated-cell-25-8" aria-hidden="true" tabindex="-1"></a>  attend_qpoiss, </span>
<span id="annotated-cell-25-9"><a href="#annotated-cell-25-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> prediction_tib </span>
<span id="annotated-cell-25-10"><a href="#annotated-cell-25-10" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-25-11"><a href="#annotated-cell-25-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exp</span>()</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-25" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-25" data-code-lines="1" data-code-annotation="1">Create a new tibble which we’ll use for prediction.</span>
</dd>
<dt data-target-cell="annotated-cell-25" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-25" data-code-lines="2" data-code-annotation="2">For any other variable type, we would just type the value for which we want to make prediction. However, the <code>predict</code> function requires variable types to be coded exactly as they are in the original dataset used for model fitting. So we need to first specify the value, then convert that value into a factor (because <code>year</code> is a factor) <em>and</em> specify the levels.</span>
</dd>
<dt data-target-cell="annotated-cell-25" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-25" data-code-lines="3" data-code-annotation="3">Set the number of recordings watched to the average, based on the table of descriptive stats we generated earlier.</span>
</dd>
<dt data-target-cell="annotated-cell-25" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-25" data-code-lines="4" data-code-annotation="4">Set the overall grade to 30 - for undergraduate modules, this is below the failing boundary of 40.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>code        1 
code 1.518625</code></pre>
</div>
</div>
<p>The model predicts that someone who is failing the module will attend 1.5 sessions, while other predictors are held constant. How about someone who’s acing the module?</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>prediction_tib <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>( </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="st">"Year 1"</span> <span class="sc">|&gt;</span> <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Year 1"</span>, <span class="st">"Year 2"</span>, <span class="st">"Year 3"</span>)), </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_record =</span> <span class="fl">5.26</span>, </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">overall_grade =</span> <span class="dv">85</span>, </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>( </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  attend_qpoiss, </span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> prediction_tib </span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exp</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>code      1 
code 3.0817</code></pre>
</div>
</div>
<p>A student who scored 85 on the module (more or less the maximum realistic grade in the UK higher education grading system) attends 3 lectures. Notwithstanding that attendance on this module seems to be extremely poor, that’s twice as many lectures compared to someone who’s under the failing boundary.</p>
</section>
</section>
<section id="zero-inflated-models-a-gentle-introduction" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="zero-inflated-models-a-gentle-introduction"><span class="header-section-number">2.4</span> Zero-inflated models (a gentle introduction)</h2>
<p>Our lecturer is in despair - there are so many students who don’t bother to attend even a single lecture. That’s terrible!</p>
<p>But then they remember an email sent to them by school office earlier that week:</p>
<blockquote class="blockquote">
<p>Dear All,</p>
<p>Please remind the students to log their attendance on the app during your sessions. We’ve seen a considerable increase in students with zero lectures attended which is inconsistent with our alternative engagement monitoring records.</p>
<p>Thank you for your cooperation.</p>
<p>The School Office</p>
</blockquote>
<p>So it is possible that students <em>are</em> attending the sessions, they’re just not logging them.</p>
<p>This is the sort of situation where <strong>zero-inflated models</strong> can help us understand some additional details about the relationships that we’re trying to model. Zero-inflation occurs when the amount of zeros observed is higher than the amount of zeros expected in a given distribution. Importantly, these zeros must be generated by a <strong>separate process</strong> (as opposed to just us mis-specifying the distribution).</p>
<p>Imagine you want to measure how much time people spend using a meditation app you’ve developed. You notice that many users have the app active for over an hour in a day, but the overall averages are low because of large spike at 0 - it seems many people don’t engage with the app on a daily basis. This might be due to various reasons - perhaps meditation is not part of their routine, perhaps they’re busy, perhaps they downloaded the app just after the New Year believing that <em>this</em> is the app that will get them into the habit of meditating. Either way, the outcome values are a result of two different processes:</p>
<ol type="1">
<li>Whether or not the user engaged with the app in a given day</li>
<li>If they did, how long was their engagement.</li>
</ol>
<p>In the lecture attendance example, it seems like zero-inflation is a plausible explanation - it might be that a lot of students are just not logging their attendance in the first place, so it makes no sense to model all these zeros together with the rest of our data.</p>
<p>This is where domain knowledge becomes important. We can test for zero-inflation, but the test doesn’t know the difference between a mis-specified model due to distribution and due to zero inflation. For example, we can use the <code>check_zeroinflation()</code> function on the Poisson Model:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_zeroinflation</span>(attend_poiss)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>code # Check for zero-inflation
code 
code    Observed zeros: 239
code   Predicted zeros: 166
code             Ratio: 0.69</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>code Model is underfitting zeros (probable zero-inflation).</code></pre>
</div>
</div>
<p>The result indicates the presence of zero-inflation. However, if we test on the negative-binomial model:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_zeroinflation</span>(attend_nb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Check for zero-inflation

   Observed zeros: 239
  Predicted zeros: 237
            Ratio: 0.99</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Model seems ok, ratio of observed and predicted zeros is within the
  tolerance range (p = 0.984).</code></pre>
</div>
</div>
<p>it seems like there’s no inflation, because the NB models is able to predict the zeros well. Therefore we <em>need</em> some sort of background knowledge that would allow to decide whether there is another process generating the zeros. Under the assumption that some students forget to (or just don’t want to) log their attendance when they are present in a session, we can fit a zero-inflated Poisson model. We’ll need to use the <code>pscl</code> package:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>attend_zi <span class="ot">&lt;-</span> pscl<span class="sc">::</span><span class="fu">zeroinfl</span>(</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  n_lectures <span class="sc">~</span> year <span class="sc">+</span> n_record  <span class="sc">+</span> overall_grade <span class="sc">|</span>  overall_grade,</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> attend_tib, </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">dist =</span> <span class="st">"poisson"</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The format of the function is very similar, however note that the formula is now split into two parts with a straight line | . The predictors that follow the straight line are the ones we believe can explain the zero inflation in the model<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> (in this case, overall grade). The <code>dist</code> argument is used as an equivalent of the <code>family</code> argument in <code>glm()</code> .</p>
<p>The over-dispersion function from <code>easystats</code> doesn’t work with these zero-inflated models, but we can calculate dispersion ratio manually with a custom function<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>dispersion_ratio <span class="ot">&lt;-</span> <span class="cf">function</span>(model){</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  E2 <span class="ot">&lt;-</span> <span class="fu">resid</span>(model, <span class="at">type =</span> <span class="st">"pearson"</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  N  <span class="ot">&lt;-</span> <span class="fu">nrow</span>(model<span class="sc">$</span>model)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  p  <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">coef</span>(model)) </span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(E2<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (N <span class="sc">-</span> p)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="fu">dispersion_ratio</span>(attend_zi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.280356</code></pre>
</div>
</div>
<p>The ratio is still above 1, suggesting we have some over-dispersion left in the model but it is much smaller than it was before.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>attend_zi <span class="sc">|&gt;</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">performance</span>() <span class="sc">|&gt;</span> </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">display</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 7%">
<col style="width: 13%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 13%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">AIC</th>
<th style="text-align: center;">AICc</th>
<th style="text-align: center;">BIC</th>
<th style="text-align: center;">R2</th>
<th style="text-align: center;">R2 (adj.)</th>
<th style="text-align: center;">RMSE</th>
<th style="text-align: center;">Sigma</th>
<th style="text-align: center;">Score_log</th>
<th style="text-align: center;">Score_spherical</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1881.7</td>
<td style="text-align: center;">1881.9</td>
<td style="text-align: center;">1912.3</td>
<td style="text-align: center;">0.08</td>
<td style="text-align: center;">0.07</td>
<td style="text-align: center;">1.60</td>
<td style="text-align: center;">1.61</td>
<td style="text-align: center;">-1.60</td>
<td style="text-align: center;">0.04</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><br></p>
<p>The R<sup>2</sup> is actually lower than the one for the original Poisson model, however these metrics are difficult to compare across models that are not nested. We’re now trying to model something more complicated than before, so we might just not be as successful as we were in modelling the a simpler relationship.</p>
<p>Finally, let’s request the parameter estimates:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>attend_zi <span class="sc">|&gt;</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">display</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption># Fixed Effects</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: center;">IRR</th>
<th style="text-align: center;">SE</th>
<th style="text-align: center;">95% CI</th>
<th style="text-align: center;">z</th>
<th style="text-align: center;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: center;">1.478</td>
<td style="text-align: center;">0.384</td>
<td style="text-align: center;">(0.888, 2.460)</td>
<td style="text-align: center;">1.503</td>
<td style="text-align: center;">0.133</td>
</tr>
<tr class="even">
<td style="text-align: left;">year [Year 2]</td>
<td style="text-align: center;">0.840</td>
<td style="text-align: center;">0.094</td>
<td style="text-align: center;">(0.674, 1.046)</td>
<td style="text-align: center;">-1.560</td>
<td style="text-align: center;">0.119</td>
</tr>
<tr class="odd">
<td style="text-align: left;">year [Year 3]</td>
<td style="text-align: center;">0.451</td>
<td style="text-align: center;">0.086</td>
<td style="text-align: center;">(0.310, 0.655)</td>
<td style="text-align: center;">-4.169</td>
<td style="text-align: center;">&lt; .001</td>
</tr>
<tr class="even">
<td style="text-align: left;">n record</td>
<td style="text-align: center;">1.000</td>
<td style="text-align: center;">0.024</td>
<td style="text-align: center;">(0.955, 1.048)</td>
<td style="text-align: center;">0.011</td>
<td style="text-align: center;">0.991</td>
</tr>
<tr class="odd">
<td style="text-align: left;">overall grade</td>
<td style="text-align: center;">1.008</td>
<td style="text-align: center;">0.003</td>
<td style="text-align: center;">(1.001, 1.015)</td>
<td style="text-align: center;">2.238</td>
<td style="text-align: center;">0.025</td>
</tr>
</tbody>
</table>
<table class="caption-top table table-sm table-striped small">
<caption># Zero-Inflation</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: center;">Odds Ratio</th>
<th style="text-align: center;">SE</th>
<th style="text-align: center;">95% CI</th>
<th style="text-align: center;">z</th>
<th style="text-align: center;">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: center;">1.236</td>
<td style="text-align: center;">0.694</td>
<td style="text-align: center;">(0.411, 3.715)</td>
<td style="text-align: center;">0.378</td>
<td style="text-align: center;">0.706</td>
</tr>
<tr class="even">
<td style="text-align: left;">overall grade</td>
<td style="text-align: center;">0.979</td>
<td style="text-align: center;">0.010</td>
<td style="text-align: center;">(0.960, 0.999)</td>
<td style="text-align: center;">-2.058</td>
<td style="text-align: center;">0.040</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><br></p>
<p>First thing to note, we have two sets of estimates - one for the <strong>Fixed Effects</strong> and one for <strong>Zero-Inflation</strong>. The fixed effects estimates are interpreted in the same way, although note that they’ve slightly changed. For example, the difference between Year 2 and Year 1 attendance is now only 16% (as opposed to 27% in the Quasi-Poisson model) and not statistically significant. This makes sense - we’re now modelling some of the non-attendance with zero-inflation.</p>
<p>Zero-inflation estimates tell us whether the predictors we specified can actually explain the excess of zeros. In effect, it is a logistic model with binary outcome, predicting whether the attendance was zero or another value, modelling the probability of a non-zero count.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a> Logistic models use the logit link, which means that exponentiating the parameter estimates converts them into odds ratios. An odds ratio (OR) of 1 means zeros and non-zeros have equal odds of occurring regardless of the levels of the predictor. OR greater than 1 means that with each unit increase in the predictor, the odds of non-zeros increase. Conversely, OR smaller than zero means that the odds decrease.</p>
<p>A brief reminder that odds are not the same as probability - it’s a ratio of probabilities:</p>
<p><span class="math display">\[
\mbox{odds} = \frac{p}{1-p}
\]</span></p>
<p>Odds are calculated as a ratio of the probability that an event occurs over the probability that it doesn’t. Consequently, odds <em>ratio</em> is the ratio of odds:<br>
</p>
<p><span class="math display">\[
OR = \frac{\mbox{odds of an event at one level of the predictor}}{\mbox{odds of an event at another level of the predictor}}
\]</span></p>
<p>In our case, overall grade had a negative relationship with attendance (OR &lt; 1). Similar to prevalence rate ratios (or “incidence rate ratios”), we can calculate the percentage change. But this time it’s not the percentage change in the value of the outcome but in the odds of a non-zero value. We take the exponentiated parameter estimate 0.979, and calculate (0.979 - 1) <span class="math inline">\(\times\)</span> 100 = -2.1. Therefore with each additional point in grade, the odds of attending the session (or at least logging attendance) decrease by 2.1 percent.</p>
<section id="deciding-between-models" class="level3">
<h3 class="anchored" data-anchor-id="deciding-between-models">Deciding between models</h3>
<p>We’ve introduced a handful of models in this tutorial. Unfortunately, there is no hard-and-fast way to compare them with some statistical test. There <em>are</em> way to compare models based on likelihood ratio tests or overall fit statistics (for an example, see section <a href="#sec-drawbacks-of-quasipoisson">The drawbacks of Quasi-models</a> ), but we cannot use these for a comparison across models that model entirely different distributions. Deciding which model to use is a skill that takes practice, context knowledge, and experience. Here are some things to consider for count models and more generally.</p>
<ul>
<li><p>Whenever possible, the decision should be made before we even start data collection (or at least before we start analysing the data).</p></li>
<li><p>What is the distribution of the variable likely going to look like? Is it bound on either side? Is it continuous or discrete? Is skewness likely?</p></li>
<li><p>For count models, is Poisson realistic? If you simulate distributions with different lambdas, do they ever achieve a realistic shape?</p></li>
<li><p>If equivalent mean-variance relationship cannot be assumed and you expect high dispersion, negative-binomial model is more appropriate.</p></li>
<li><p>Consider Quasi-Poisson if the dispersion is too high for Poisson and too low for Negative-Binomial. This is more of a post-hoc solution rather than an ad-hoc plan.</p></li>
<li><p>Alternatively, if an under-dispersed Negative-Binomial model is making accurate predictions and you don’t care about hypothesis testing, stick with it instead of a Quasi-model.</p></li>
<li><p>When planning analysis, consider how the data are collected. Is there any mechanism that could generate an excess of zeros? If so, plan a model accounting for zero-inflation with an appropriate distribution family.</p></li>
</ul>
</section>
<section id="report" class="level3">
<h3 class="anchored" data-anchor-id="report">Report</h3>
<p>Count models are very similar in interpretation to Gamma models - you can use the <a href="01a_gzlms_skewed.html#sec-report-gamma">report example</a> as a guideline. Here is a reminder on what to report and some tips:</p>
<ul>
<li><p>Brief summary of key insights from descriptive statistics and visualisation.</p></li>
<li><p>State what sort of model you fitted.</p></li>
<li><p>Summarise any assumption checks, highlight potential problems if there are any.</p></li>
<li><p>Report and interpret model fit statistics, i.e.&nbsp;the <em>F</em> test and a pseudo R<sup>2</sup></p></li>
<li><p>Report parameter estimates</p>
<ul>
<li><p>Report and interpret the betas. For effects described in percentage change, try to contextualise the size of the effect (optionally with a prediction)</p></li>
<li><p>Report confidence intervals - consider fully interpreting them, especially if either end of an interval challenges the conclusion that would be drawn from a beta alone.</p></li>
<li><p>Report the standard error, the <em>t</em> statistic, and the <em>p</em>-value</p></li>
<li><p>If you only have a handful of predictors, report them all. If you have many of them, it’s fine to focus on the key predictors stated in your hypothesis, and provide a summary description for the effects of others (e.g.&nbsp;“all the covariates had a moderate positive association with the outcome, <em>p</em>s &lt; .001”), while pointing reader to a table where they find the full results.</p></li>
<li><p>For zero-inflated models report and interpret both the fixed effects and zero-inflation.</p></li>
</ul></li>
<li><p>Summarise the findings, referring back to the hypothesis.</p></li>
</ul>
</section>
</section>
<section id="exercises" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="exercises"><span class="header-section-number">2.5</span> Exercises</h2>
<section id="what-does-this-code-do" class="level3">
<h3 class="anchored" data-anchor-id="what-does-this-code-do">What does this code do?</h3>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Here’s all the code we have written in this section. Can you remember what each line of each codechunk does? Are there any codechunks that you struggle to make sense of? Make sure to revisit the section in which it is used and take notes.</p>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>attend_tib <span class="ot">&lt;-</span> attend_tib <span class="sc">|&gt;</span> </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">year =</span> <span class="fu">factor</span>(year)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(attend_tib<span class="sc">$</span>year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">describe_distribution</span>(attend_tib, <span class="at">include_factors =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">display</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">data =</span> attend_tib, <span class="fu">aes</span>(<span class="at">x =</span> n_lectures)) <span class="sc">+</span> </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"yellowgreen"</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span> </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">stat =</span> <span class="st">"count"</span>) <span class="sc">+</span> </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">stat =</span> <span class="st">"count"</span>) <span class="sc">+</span> </span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">11</span>, <span class="dv">1</span>)) <span class="sc">+</span>  </span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">data =</span> attend_tib, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> n_lectures)) <span class="sc">+</span> </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>), <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">colour =</span> <span class="st">"yellowgreen"</span>) <span class="sc">+</span> </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">colour =</span> <span class="st">"steelblue"</span>, <span class="at">fun.data =</span> <span class="st">"mean_cl_normal"</span>) <span class="sc">+</span> </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">11</span>, <span class="dv">1</span>)) <span class="sc">+</span>  </span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">data =</span> attend_tib, <span class="fu">aes</span>(<span class="at">x =</span> overall_grade, <span class="at">y =</span> n_lectures)) <span class="sc">+</span> </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>), <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">colour =</span> <span class="st">"yellowgreen"</span>) <span class="sc">+</span> </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"glm"</span>, <span class="at">colour =</span> <span class="st">"steelblue"</span>, <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> <span class="st">"poisson"</span>)) <span class="sc">+</span> </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>poisson_dist <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">lambda =</span> <span class="dv">1</span>) </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="cn">NULL</span>, <span class="fu">aes</span>(<span class="at">x =</span> poisson_dist)) <span class="sc">+</span> </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>attend_poiss <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  n_lectures <span class="sc">~</span> year <span class="sc">+</span> n_record <span class="sc">+</span> overall_grade, </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> attend_tib, </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">poisson</span>(<span class="at">link =</span> <span class="st">"log"</span>) </span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_model</span>(attend_poiss)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_overdispersion</span>(attend_poiss)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>nb_dist <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">rnegbin</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">mu =</span> <span class="dv">1</span>, <span class="at">theta =</span> <span class="fl">0.5</span>) </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="cn">NULL</span>, <span class="fu">aes</span>(<span class="at">x =</span> nb_dist)) <span class="sc">+</span> </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>attend_nb <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">glm.nb</span>(</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  n_lectures <span class="sc">~</span> n_record <span class="sc">+</span> year <span class="sc">+</span> overall_grade, </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> attend_tib</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>attend_qpoiss <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  n_lectures <span class="sc">~</span> year <span class="sc">+</span> n_record  <span class="sc">+</span> overall_grade, </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> attend_tib, </span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">quasipoisson</span>(<span class="at">link =</span> <span class="st">"log"</span>)</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">performance</span>(attend_qpoiss) <span class="sc">|&gt;</span> </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">display</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">test_wald</span>(attend_qpoiss) <span class="sc">|&gt;</span> </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">display</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>attend_qpoiss <span class="sc">|&gt;</span> </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">model_parameters</span>(<span class="at">exponentiate =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">display</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>prediction_tib <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>( </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="st">"Year 1"</span> <span class="sc">|&gt;</span> <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Year 1"</span>, <span class="st">"Year 2"</span>, <span class="st">"Year 3"</span>)), </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_record =</span> <span class="fl">5.26</span>, </span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">overall_grade =</span> <span class="dv">30</span>, </span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>( </span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  attend_qpoiss, </span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> prediction_tib </span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exp</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>prediction_tib <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>( </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="st">"Year 1"</span> <span class="sc">|&gt;</span> <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Year 1"</span>, <span class="st">"Year 2"</span>, <span class="st">"Year 3"</span>)), </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_record =</span> <span class="fl">5.26</span>, </span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">overall_grade =</span> <span class="dv">85</span>, </span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>( </span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  attend_qpoiss, </span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> prediction_tib </span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exp</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_zeroinflation</span>(attend_poiss)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>attend_zi <span class="ot">&lt;-</span> pscl<span class="sc">::</span><span class="fu">zeroinfl</span>(</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  n_lectures <span class="sc">~</span> year <span class="sc">+</span> n_record  <span class="sc">+</span> overall_grade <span class="sc">|</span>  overall_grade,</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> attend_tib, </span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">dist =</span> <span class="st">"poisson"</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="worksheet" class="level3">
<h3 class="anchored" data-anchor-id="worksheet">Worksheet</h3>
<blockquote class="blockquote">
<p>A social psychologist studies the predictors of popularity on social media. They randomly selects 212 BlueSky users and extracts information about their accounts and posting habits. Popularity is conceptualised by the number of followers (<code>n_followers</code>). The predictors to test are:</p>
<ol type="1">
<li>Frequency of posting (<code>frequency</code>): Factor with levels “Less than once a day”, “Once a day”, “More than once a day”.</li>
<li>Primary post type (<code>post_type</code>): Factor with levels “Unique posts” and “Reposts”</li>
<li>Proportion of posts containing cute animal photos or videos (<code>animal_posts</code>) measured as a percentage.</li>
</ol>
<p>The researcher hypothesises that:</p>
<ul>
<li><p>H1: Frequent posters will have more followers compared to those posting less frequently.</p></li>
<li><p>H2: Users who primarily post unique posts rather than reposts will have more followers.</p></li>
<li><p>H3: Users who post content related to cute animals more frequently will have more followers.</p></li>
</ul>
<p>The researcher gets started on the analysis. So far they have fitted a Poisson model and a Gamma model. They think the Gamma model is a better fit, but they want you to look over the output and suggest improvements if needed. The output for each model is displayed below.</p>
</blockquote>
<p>The data are stored in the file <a href="data/follower_data.csv">follower_data.csv</a> .</p>
<div class="callout callout-style-simple callout-tip">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Use the tutorial to complete the following tasks:</strong></p>
<ol type="1">
<li>Review the output provided to you.</li>
<li>If there is an alternative model that can be fitted, do so.</li>
<li>Compare all the outputs and select the best fitting model. Articulate your decision.</li>
<li>Extract overall fit statistics and parameter estimates from the model you selected.</li>
<li>(Optional) Create data visualisation to help you with interpretation.</li>
<li>Write up the results is a short report.</li>
</ol>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="01b_gzlms_counts_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="poisson-model-output" class="level4">
<h4 class="anchored" data-anchor-id="poisson-model-output"><strong>Poisson model output:</strong></h4>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="01b_gzlms_counts_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="gamma-model-output" class="level4">
<h4 class="anchored" data-anchor-id="gamma-model-output"><strong>Gamma model output:</strong></h4>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="01b_gzlms_counts_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Optional task
</div>
</div>
<div class="callout-body-container callout-body">
<p>What does the model you consider to be the best fitting predict for a BlueSky user who <em>only</em> posts unique posts with cute animals more than once per day?</p>
</div>
</div>
</section>
</section>
<section id="check-worksheet-values" class="level3">
<h3 class="anchored" data-anchor-id="check-worksheet-values">Check worksheet values</h3>
<p>Once you’ve finished the worksheet, you can ask me to look through your work and give you feedback. Remember that you should also practice writing up the results in a brief report, not just running the code. If you’re stuck, you can use the quiz below to guide you.</p>
<p>You can also use the quiz below - if you fitted the models the correctly, your answers should match the values below.</p>
<div class="callout callout-style-simple callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Worksheet check
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Based on the diagnostic checks, the model that should be selected is:</p>
<div id="radio_LTHHJKUKKS" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_LTHHJKUKKS" value=""> <span>Gamma model</span></label><label><input type="radio" autocomplete="off" name="radio_LTHHJKUKKS" value=""> <span>Poisson model</span></label><label><input type="radio" autocomplete="off" name="radio_LTHHJKUKKS" value="answer"> <span>A different model</span></label>
</div>
<p>Total deviance explained: 70.3 %</p>
<p>Overall <em>F</em> statistic: 2.76</p>
<p><strong>Parameter estimates (IRR)</strong>:</p>
<ul>
<li><p>Posting frequency (Once a day vs less than once a day): 1.71</p></li>
<li><p>Posting frequency (More than once a day vs less than once a day): 2.53</p></li>
<li><p>Post type (Unique posts vs reposts): 1.71</p></li>
<li><p>Percentage of animal posts: 1.04</p></li>
</ul>
<p>The results are in line with Hypothesis 1:</p>
<div id="radio_GIAOIYAIDV" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_GIAOIYAIDV" value="answer"> <span>TRUE</span></label><label><input type="radio" autocomplete="off" name="radio_GIAOIYAIDV" value=""> <span>FALSE</span></label>
</div>
<p>The results are in line with Hypothesis 2:</p>
<div id="radio_XMVWARKKGM" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_XMVWARKKGM" value="answer"> <span>TRUE</span></label><label><input type="radio" autocomplete="off" name="radio_XMVWARKKGM" value=""> <span>FALSE</span></label>
</div>
<p>The results are in line with Hypothesis 3:</p>
<div id="radio_FLWKXCBIJW" class="webex-radiogroup">
<label><input type="radio" autocomplete="off" name="radio_FLWKXCBIJW" value="answer"> <span>TRUE</span></label><label><input type="radio" autocomplete="off" name="radio_FLWKXCBIJW" value=""> <span>FALSE</span></label>
</div>
<p><strong>Optional task:</strong></p>
<p>Model prediction: 1460.65</p>
</div>
</div>
</div>


</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>In case someone messed up at the first hurdle and uploaded the wrong file…<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>But if we wanted to, we could do so in the same way as in an OLS model<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>I’m not trying to make any statement here about how students with better or worse grades are more or less likely to log their attendance. Zero-inflated models are a pain to simulate so it just so happens that this variable ended up being a predictor. In reality, the variable that we specify as a predictor of zero inflation needs to have some theoretical justification.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>We don’t really cover how to write custom functions on this module but if you’d like to know more, you can ask me in the session.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>If you would find a recap of logistic regression helpful, you can revisit the DiscovR 19 tutorial (Categorical outcomes).<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;
    
    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");
  
  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");
  
  var cl = this.classList
  
  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;
  
  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }
  
  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

window.onload = function() {
  console.log("onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }
  
  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }
  
  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
  }

  update_total_correct();
}

</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./01a_gzlms_skewed.html" class="pagination-link" aria-label="Modelling skewness">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Modelling skewness</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./01c_gzlms_ordinal.html" class="pagination-link" aria-label="Modelling ordinal outcomes">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Modelling ordinal outcomes</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>